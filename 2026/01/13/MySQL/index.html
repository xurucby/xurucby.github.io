<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL | xuru的技术学习博客</title><meta name="author" content="xuru"><meta name="copyright" content="xuru"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文详细讲解MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="https://xurucby.github.io/2026/01/13/MySQL/index.html">
<meta property="og:site_name" content="xuru的技术学习博客">
<meta property="og:description" content="本文详细讲解MySQL">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xurucby.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2026-01-13T03:31:57.000Z">
<meta property="article:modified_time" content="2026-01-13T03:44:47.025Z">
<meta property="article:author" content="xuru">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xurucby.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL",
  "url": "https://xurucby.github.io/2026/01/13/MySQL/",
  "image": "https://xurucby.github.io/img/butterfly-icon.png",
  "datePublished": "2026-01-13T03:31:57.000Z",
  "dateModified": "2026-01-13T03:44:47.025Z",
  "author": [
    {
      "@type": "Person",
      "name": "xuru",
      "url": "https://xurucby.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://xurucby.github.io/2026/01/13/MySQL/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">xuru的技术学习博客</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">MySQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-13T03:31:57.000Z" title="发表于 2026-01-13 11:31:57">2026-01-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-01-13T03:44:47.025Z" title="更新于 2026-01-13 11:44:47">2026-01-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL/">MySQL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="1-数据库"><a href="#1-数据库" class="headerlink" title="1. 数据库"></a>1. 数据库</h2><h3 id="1-1概述"><a href="#1-1概述" class="headerlink" title="1.1概述"></a>1.1概述</h3><ul>
<li>数据存储</li>
</ul>
<ol>
<li><p>人工管理阶段</p>
<p>缺点 ：  数据存储量有限，共享处理麻烦，操作容易混乱</p>
</li>
<li><p>文件管理阶段 （.txt  .doc  .xls）</p>
<p>优点 ：  数据可以长期保存,可以存储大量的数据,使用简单。</p>
<p>缺点 ：  数据一致性差,数据查找修改不方便,数据冗余度可能比较大。</p>
</li>
<li><p>数据库管理阶段</p>
<p>优点 ： 数据组织结构化降低了冗余度,提高了增删改查的效率,容易扩展,方便程序调用处理</p>
<p>缺点 ： 需要使用sql 或者其他特定的语句，相对比较专业</p>
</li>
</ol>
<ul>
<li><p>数据库应用领域</p>
<p>数据库的应用领域几乎涉及到了需要数据管理的方方面面，融机构、游戏网站、购物网站、论坛网站 … …都需要数据库进行数据存储管理。</p>
</li>
</ul>
<p><img src="/./img/view.jpg"></p>
<ul>
<li>基本概念</li>
<li>数据库 ： 按照数据一定结构，存储管理数据的仓库。数据库是在数据库管理系统管理和控制下，在一定介质上的数据集合。</li>
<li>数据库管理系统 ：管理数据库的软件，用于建立和维护数据库。</li>
</ul>
<p><img src="/./img/shujukuxitong.png"></p>
<ul>
<li><p>关系型数据库和非关系型数据库</p>
<blockquote>
<p>关系型： 采用关系模型（二维表）来组织数据结构的数据库 ，如Oracle 、SQL_Server、 MySQL</p>
<p>非关系型： 不采用关系模型组织数据结构的数据库，如：MongoDB、Redis</p>
</blockquote>
<p><img src="/./img/databases.jpg"></p>
</li>
</ul>
<h3 id="1-2-MySQL"><a href="#1-2-MySQL" class="headerlink" title="1.2 MySQL"></a>1.2 MySQL</h3><p>1996年，MySQL 1.0发布,作者Monty Widenius, 为一个叫TcX的公司打工，当时只是内部发布。到了96年10月，MySQL 3.11.1发布了，一个月后，Linux版本出现了。真正的MySQL关系型数据库于1998年1月发行第一个版本。MySQL是个开源数据库，后来瑞典有了专门的MySQL开发公司，将该数据库发展壮大，在之后被Sun收购，Sun又被Oracle收购。</p>
<p>官网地址：<a target="_blank" rel="noopener" href="https://www.mysql.com/">https://www.mysql.com/</a></p>
<p><img src="/./img/mysql.jpg"></p>
<ul>
<li><p>MySQL特点</p>
<ol>
<li>是开源数据库，使用C和C++编写 </li>
<li>能够工作在众多不同的平台上</li>
<li>提供了用于C、C++、Python、Java、Perl、PHP、Ruby众多语言的API</li>
<li>存储结构优良，运行速度快</li>
<li>功能全面丰富</li>
</ol>
</li>
<li><p>MySQL安装</p>
<ul>
<li>Ubuntu安装MySQL服务<ul>
<li>终端执行: sudo apt  install mysql-server</li>
<li>配置文件：&#x2F;etc&#x2F;mysql</li>
<li>数据库存储目录 ：&#x2F;var&#x2F;lib&#x2F;mysql</li>
</ul>
</li>
<li>Windows&#x2F;MacOS安装MySQL<ul>
<li>下载MySQL安装包  <a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/windows/installer/8.0.html">https://dev.mysql.com/downloads/windows/installer/8.0.html</a></li>
<li>直接运行安装文件安装</li>
</ul>
</li>
</ul>
</li>
<li><p>启动和连接MySQL服务</p>
<ul>
<li><p>服务端启动</p>
<ul>
<li>查看MySQL状态 : sudo  service  mysql  status</li>
<li>启动&#x2F;停止&#x2F;重启服务：sudo  service  mysql    start&#x2F;stop&#x2F;restart</li>
</ul>
</li>
<li><p>连接数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql    <span class="operator">-</span>h  主机地址   <span class="operator">-</span>u  用户名    <span class="operator">-</span>p  </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<blockquote>
<p>注意： </p>
<ol>
<li>回车后输入数据库密码 （我们设置的是123456）</li>
<li>如果链接自己主机数据库可省略 -h 选项</li>
</ol>
</blockquote>
<ul>
<li><p>关闭连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl<span class="operator">-</span>D</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>


</li>
<li><p>MySQL数据库结构</p>
</li>
</ul>
<blockquote>
<p>数据元素 –&gt; 记录 –&gt;数据表 –&gt; 数据库</p>
</blockquote>
<p><img src="/./img/kujiegou.png"></p>
<ul>
<li>基本概念解析<ul>
<li>数据表（table） ： 存放数据的表格 </li>
<li>字段（column）： 每个列，用来表示该列数据的含义</li>
<li>记录（row）： 每个行，表示一组完整的数据</li>
</ul>
</li>
</ul>
<p><img src="/./img/biaojiegou.png"></p>
<h3 id="1-3-SQL语言"><a href="#1-3-SQL语言" class="headerlink" title="1.3 SQL语言"></a>1.3 SQL语言</h3><ul>
<li>什么是SQL</li>
</ul>
<p>结构化查询语言(Structured Query Language)，一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。</p>
<ul>
<li>SQL语言特点<ul>
<li>SQL语言基本上独立于数据库本身</li>
<li>各种不同的数据库对SQL语言的支持与标准存在着细微的不同</li>
<li>每条命令以 ; 结尾</li>
<li>SQL命令（除了数据库名和表名）关键字和字符串可以不区分字母大小写</li>
</ul>
</li>
</ul>
<h2 id="2-数据库基础操作"><a href="#2-数据库基础操作" class="headerlink" title="2. 数据库基础操作"></a>2. 数据库基础操作</h2><h3 id="2-1-数据库管理"><a href="#2-1-数据库管理" class="headerlink" title="2.1 数据库管理"></a>2.1 数据库管理</h3><ol>
<li>查看已有库</li>
</ol>
<blockquote>
<p>show databases;</p>
</blockquote>
<ol start="2">
<li>创建库</li>
</ol>
<blockquote>
<p>create database 库名 [character set utf8];</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e.g. 创建stu数据库，编码为utf8</span><br><span class="line"><span class="keyword">create</span> database stu <span class="keyword">character set</span> utf8;</span><br><span class="line"><span class="keyword">create</span> database stu charset<span class="operator">=</span>utf8;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：数据库命名</p>
<ol>
<li>数字、字母、下划线,但不能使用纯数字</li>
<li>库名区分字母大小写</li>
<li>不要使用特殊字符和mysql关键字</li>
</ol>
</blockquote>
<ol start="3">
<li>切换库</li>
</ol>
<blockquote>
<p>use 库名;</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g. 使用stu数据库</span><br><span class="line">use stu;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>删除库</li>
</ol>
<blockquote>
<p>drop database 库名;</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g. 删除test数据库</span><br><span class="line"><span class="keyword">drop</span> database test;</span><br></pre></td></tr></table></figure>



<h3 id="2-2-数据表管理"><a href="#2-2-数据表管理" class="headerlink" title="2.2 数据表管理"></a>2.2 数据表管理</h3><ul>
<li>基本思考过程<ol>
<li>确定存储内容</li>
<li>明确字段构成</li>
<li>确定字段数据类型</li>
</ol>
</li>
</ul>
<h4 id="2-2-1-基础数据类型"><a href="#2-2-1-基础数据类型" class="headerlink" title="2.2.1 基础数据类型"></a>2.2.1 基础数据类型</h4><ul>
<li>数字类型：<ul>
<li>整数类型：INT，SMALLINT，TINYINT，MEDIUMINT，BIGINT</li>
<li>浮点类型：FLOAT，DOUBLE，DECIMAL</li>
<li>比特值类型：BIT</li>
</ul>
</li>
</ul>
<p><img src="/./img/shuzi.png"></p>
<blockquote>
<p>注意：</p>
<ol>
<li>对于准确性要求比较高的东西，比如money，用decimal类型减少存储误差。声明语法是DECIMAL(M,D)。M是数字的最大数字位数，D是小数点右侧数字的位数。比如 DECIMAL(6,2)最多存6位数字，小数点后占2位,取值范围-9999.99到9999.99。</li>
<li>float(5，2)  float后的数字5表示数字位数，2表示精确到小数点后2位。</li>
<li>比特值类型指0，1值表达2种情况，如真，假。</li>
</ol>
</blockquote>
<hr>
<ul>
<li>字符串类型：<ul>
<li>普通字符串： CHAR，VARCHAR</li>
<li>存储文本：TEXT</li>
<li>存储二进制数据： BLOB</li>
<li>存储选项型数据：ENUM，SET</li>
</ul>
</li>
</ul>
<p><img src="/./img/zifuchuan.png"></p>
<blockquote>
<p>注意：</p>
<ol>
<li>char：定长，即指定存储字节数后，无论实际存储了多少字节数据，最终都占指定的字节大小。默认只能存1字节数据。存取效率高。</li>
<li>varchar：不定长，效率偏低 ，但是节省空间，实际占用空间根据实际存储数据大小而定。必须要指定存储大小 varchar(50)</li>
<li>enum用来存储给出的多个值中的一个值,即单选，enum(‘A’,’B’,’C’)</li>
<li>set用来存储给出的多个值中一个或多个值，即多选，set(‘A’,’B’,’C’)</li>
</ol>
</blockquote>
<h4 id="2-2-2-表的基本操作"><a href="#2-2-2-表的基本操作" class="headerlink" title="2.2.2 表的基本操作"></a>2.2.2 表的基本操作</h4><ul>
<li>创建表</li>
</ul>
<blockquote>
<p>create table 表名(字段名 数据类型 约束,字段名 数据类型 约束,…字段名 数据类型 约束);</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> class (</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">age tinyint,</span><br><span class="line">sex enum(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;w&#x27;</span>),</span><br><span class="line">score <span class="type">float</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<ul>
<li>字段约束<ul>
<li>如果你想设置数字为无符号则加上 UNSIGNED</li>
<li>如果你不想字段为 NULL 可以设置字段的属性为 NOT NULL， 在操作数据库时如果输入该字段的数据为NULL ，就会报错。</li>
<li>DEFAULT 表示设置一个字段的默认值</li>
<li>COMMENT  增加字段说明</li>
<li>AUTO_INCREMENT 定义列为自增的属性，一般用于主键，数值会自动加1。</li>
<li>PRIMARY KEY 关键字用于定义列为主键。主键的值不能重复,且不能为空。</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">e.g.  创建班级表</span><br><span class="line"><span class="keyword">create table</span> class (</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">not null</span>,</span><br><span class="line">age tinyint unsigned,</span><br><span class="line">sex enum(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;o&#x27;</span>),</span><br><span class="line">score <span class="type">float</span> <span class="keyword">default</span> <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">e.g. 创建兴趣班表</span><br><span class="line"><span class="keyword">create table</span> hobby (</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">char</span>(<span class="number">30</span>) <span class="keyword">not null</span>,</span><br><span class="line">hobby <span class="keyword">set</span>(&quot;sing&quot;,&quot;dance&quot;,&quot;draw&quot;),</span><br><span class="line">level <span class="type">char</span>  comment &quot;评级&quot;,</span><br><span class="line">price <span class="type">decimal</span>(<span class="number">7</span>,<span class="number">2</span>),</span><br><span class="line">remark text  comment &quot;备注信息&quot;</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>查看数据表</p>
<blockquote>
<p>show  tables；</p>
</blockquote>
</li>
<li><p>查看表结构</p>
<blockquote>
<p>desc  表名;</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">desc class;</span><br></pre></td></tr></table></figure>


</li>
<li><p>查看数据表创建信息</p>
<blockquote>
<p>show  create  table  表名；</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create table class;</span><br></pre></td></tr></table></figure>


</li>
<li><p>删除表</p>
<blockquote>
<p>drop  table  表名;</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop table student;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-表数据基本操作"><a href="#2-3-表数据基本操作" class="headerlink" title="2.3 表数据基本操作"></a>2.3 表数据基本操作</h3><h4 id="2-3-1-插入-insert"><a href="#2-3-1-插入-insert" class="headerlink" title="2.3.1 插入(insert)"></a>2.3.1 插入(insert)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> 表名 <span class="keyword">values</span> (值<span class="number">1</span>，值<span class="number">2.</span>..),(值<span class="number">1</span>，值<span class="number">2.</span>..),...;</span><br><span class="line"><span class="keyword">insert into</span> 表名 (字段<span class="number">1</span>,...) <span class="keyword">values</span> (值<span class="number">1</span>，值<span class="number">2.</span>..),...;</span><br><span class="line"></span><br><span class="line"><span class="operator">*</span> <span class="keyword">values</span> 也可以写 <span class="keyword">value</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> class <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,&quot;Lily&quot;,<span class="number">18</span>,<span class="string">&#x27;f&#x27;</span>,<span class="number">89</span>),</span><br><span class="line">(<span class="number">2</span>,&quot;Lucy&quot;,<span class="number">18</span>,<span class="string">&#x27;f&#x27;</span>,<span class="number">76</span>),</span><br><span class="line">(<span class="number">3</span>,&quot;Tom&quot;,<span class="number">17</span>,<span class="string">&#x27;m&#x27;</span>,<span class="number">83</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> class</span><br><span class="line">(name,age,sex,score)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(&quot;Levi&quot;,<span class="number">18</span>,<span class="string">&#x27;m&#x27;</span>,<span class="number">86</span>),</span><br><span class="line">(&quot;Sunny&quot;,<span class="number">17</span>,<span class="string">&#x27;m&#x27;</span>,<span class="number">91</span>),</span><br><span class="line">(&quot;Eva&quot;,<span class="number">17</span>,<span class="string">&#x27;f&#x27;</span>,<span class="number">71</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> hobby</span><br><span class="line">(name,hobby,level,price,remark)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(&quot;Joy&quot;,&quot;sing,dance&quot;,&quot;A&quot;,<span class="number">56800</span>,&quot;骨骼惊奇&quot;),</span><br><span class="line">(&quot;Abby&quot;,&quot;sing&quot;,&quot;B&quot;,<span class="number">14800.888</span>,&quot;天籁之音&quot;),</span><br><span class="line">(&quot;Barom&quot;,&quot;draw&quot;,&quot;B&quot;,<span class="number">26800.00</span>,&quot;当代达芬奇&quot;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> hobby</span><br><span class="line">(name,hobby,level,price)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(&quot;Jame&quot;,&quot;dance&quot;,&quot;C&quot;,<span class="number">8800</span>),</span><br><span class="line">(&quot;Emma&quot;,&quot;draw,sing&quot;,&quot;B&quot;,<span class="number">44800</span>),</span><br><span class="line">(&quot;Chen&quot;,&quot;sing&quot;,&quot;C&quot;,<span class="number">16800</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">随堂练习：</span><br><span class="line">创建一个数据库  exercise</span><br><span class="line"></span><br><span class="line">创建一个数据表  books  类型和约束自己设计 ，字段 ： id  书名   作者   出版社  价格   备注</span><br><span class="line"></span><br><span class="line">向其中插入数据若干  <span class="operator">&gt;=</span> <span class="number">6</span>条</span><br><span class="line">参考 ： 老舍  沈从文  鲁迅  冰心  ....</span><br><span class="line">出版社 ： 中国文学  人民教育   机械工业</span><br><span class="line">价格 ：  <span class="number">30</span><span class="number">-120</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">创建一个数据库  books</span><br><span class="line"><span class="keyword">create</span> database books charset<span class="operator">=</span>utf8;</span><br><span class="line">use books;</span><br><span class="line"></span><br><span class="line">创建一个数据表  books  类型和约束自己设计 ，字段 ： id  书名   作者   出版社  价格   备注</span><br><span class="line"><span class="keyword">create table</span> books(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">bname <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">not null</span>,</span><br><span class="line">author  <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">default</span> &quot;佚名&quot;,</span><br><span class="line">press <span class="type">varchar</span>(<span class="number">128</span>),</span><br><span class="line">price <span class="type">float</span> unsigned,</span><br><span class="line">comment text</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">向其中插入数据若干  <span class="operator">&gt;=</span> <span class="number">6</span>条</span><br><span class="line">参考 ： 老舍  沈从文  鲁迅  冰心  ....</span><br><span class="line">出版社 ： 中国文学  人民教育   机械工业</span><br><span class="line">价格 ：  <span class="number">30</span><span class="number">-120</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> books</span><br><span class="line">(bname,author,press,price,comment)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(&quot;边城&quot;,&quot;沈从文&quot;,&quot;机械工业出版社&quot;,<span class="number">36</span>,&quot;小城故事多&quot;),</span><br><span class="line">(&quot;骆驼祥子&quot;,&quot;老舍&quot;,&quot;机械工业出版社&quot;,<span class="number">43</span>,&quot;你是祥子么？&quot;),</span><br><span class="line">(&quot;茶馆&quot;,&quot;老舍&quot;,&quot;中国文学出版社&quot;,<span class="number">55</span>,&quot;老北京&quot;),</span><br><span class="line">(&quot;呐喊&quot;,&quot;鲁迅&quot;,&quot;人民教育出版社&quot;,<span class="number">71</span>,&quot;最后的声音&quot;),</span><br><span class="line">(&quot;朝花夕拾&quot;,&quot;鲁迅&quot;,&quot;中国文学出版社&quot;,<span class="number">53</span>,&quot;好时光&quot;),</span><br><span class="line">(&quot;围城&quot;,&quot;钱钟书&quot;,&quot;中国文学出版社&quot;,<span class="number">44</span>,&quot;你心中的围城是什么&quot;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> books</span><br><span class="line">(bname,author,press,price)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">(&quot;林家铺子&quot;,&quot;茅盾&quot;,&quot;机械工业出版社&quot;,<span class="number">51</span>),</span><br><span class="line">(&quot;子夜&quot;,&quot;茅盾&quot;,&quot;人民教育出版社&quot;,<span class="number">47</span>);</span><br></pre></td></tr></table></figure>



<h4 id="2-3-2-查询-select"><a href="#2-3-2-查询-select" class="headerlink" title="2.3.2 查询(select)"></a>2.3.2 查询(select)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 [<span class="keyword">where</span> 条件];</span><br><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span> <span class="keyword">from</span> 表名 [<span class="keyword">where</span> 条件];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e.g. </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class;</span><br><span class="line"><span class="keyword">select</span> name,age <span class="keyword">from</span> class;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2-3-3-where子句"><a href="#2-3-3-where子句" class="headerlink" title="2.3.3 where子句"></a>2.3.3 where子句</h4><p>where子句在sql语句中扮演了重要角色，主要通过一定的运算条件进行数据的筛选，在查询，删除，修改中都有使用。</p>
<ul>
<li>算数运算符</li>
</ul>
<p><img src="/./img/suanshu.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class_1 <span class="keyword">where</span> age <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>比较运算符</li>
</ul>
<p><img src="/./img/bijiao.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">8</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> age <span class="keyword">between</span> <span class="number">8</span> <span class="keyword">and</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> age <span class="keyword">in</span> (<span class="number">8</span>,<span class="number">9</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex <span class="keyword">is</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>逻辑运算符</li>
</ul>
<p><img src="/./img/luoji.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">and</span> age<span class="operator">&gt;</span><span class="number">9</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="/./img/yunsuanfu.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">查询练习</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 查找<span class="number">30</span>多元的图书</span><br><span class="line">２．查找人民教育出版社出版的图书　</span><br><span class="line">３．查找老舍写的，中国文学出版社出版的图书　</span><br><span class="line">４．查找备注不为空的图书</span><br><span class="line">５．查找价格超过<span class="number">60</span>元的图书，只看书名和价格</span><br><span class="line">６．查找鲁迅写的或者茅盾写的图书</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 查找<span class="number">30</span>多元的图书</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">where</span> price <span class="keyword">between</span> <span class="number">30</span> <span class="keyword">and</span> <span class="number">39.99</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>．查找人民教育出版社出版的图书　</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> books <span class="keyword">where</span> press<span class="operator">=</span>&quot;人民教育出版社&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>．查找老舍写的，中国文学出版社出版的图书　</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">where</span> author<span class="operator">=</span>&quot;老舍&quot; <span class="keyword">and</span> press<span class="operator">=</span>&quot;中国文学出版社&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>．查找备注不为空的图书</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> books <span class="keyword">where</span> comment <span class="keyword">is</span> <span class="keyword">not null</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>．查找价格超过<span class="number">60</span>元的图书，只看书名和价格</span><br><span class="line"><span class="keyword">select</span> bname,price <span class="keyword">from</span> books <span class="keyword">where</span> price<span class="operator">&gt;</span><span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>．查找鲁迅写的或者茅盾写的图书</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> books <span class="keyword">where</span> author <span class="keyword">in</span> (&quot;鲁迅&quot;,&quot;茅盾&quot;);</span><br></pre></td></tr></table></figure>



<h4 id="2-3-4-更新表记录-update"><a href="#2-3-4-更新表记录-update" class="headerlink" title="2.3.4 更新表记录(update)"></a>2.3.4 更新表记录(update)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 表名 <span class="keyword">set</span> 字段<span class="number">1</span><span class="operator">=</span>值<span class="number">1</span>,字段<span class="number">2</span><span class="operator">=</span>值<span class="number">2</span>,... <span class="keyword">where</span> 条件;</span><br><span class="line"></span><br><span class="line">注意:<span class="keyword">update</span>语句后如果不加<span class="keyword">where</span>条件,所有记录全部更新</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">update</span> class <span class="keyword">set</span> age<span class="operator">=</span><span class="number">18</span>,score<span class="operator">=</span><span class="number">91</span> <span class="keyword">where</span> name<span class="operator">=</span>&quot;Abby&quot;;</span><br><span class="line"><span class="keyword">update</span> class <span class="keyword">set</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">where</span> sex <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">update</span> class <span class="keyword">set</span> age<span class="operator">=</span>age<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2-3-5-删除表记录（delete）"><a href="#2-3-5-删除表记录（delete）" class="headerlink" title="2.3.5 删除表记录（delete）"></a>2.3.5 删除表记录（delete）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件;</span><br><span class="line"></span><br><span class="line">注意:<span class="keyword">delete</span>语句后如果不加<span class="keyword">where</span>条件,所有记录全部清空</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> class <span class="keyword">where</span> score<span class="operator">=</span><span class="number">0</span> <span class="keyword">and</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="2-3-6-表字段的操作-alter"><a href="#2-3-6-表字段的操作-alter" class="headerlink" title="2.3.6 表字段的操作(alter)"></a>2.3.6 表字段的操作(alter)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">语法 ：<span class="keyword">alter table</span> 表名 执行动作;</span><br><span class="line"></span><br><span class="line"><span class="operator">*</span> 添加字段(<span class="keyword">add</span>)</span><br><span class="line">    <span class="keyword">alter table</span> 表名 <span class="keyword">add</span> 字段名 数据类型;</span><br><span class="line">    <span class="keyword">alter table</span> 表名 <span class="keyword">add</span> 字段名 数据类型 <span class="keyword">first</span>;</span><br><span class="line">    <span class="keyword">alter table</span> 表名 <span class="keyword">add</span> 字段名 数据类型 after 字段名;</span><br><span class="line"><span class="operator">*</span> 删除字段(<span class="keyword">drop</span>)</span><br><span class="line">    <span class="keyword">alter table</span> 表名 <span class="keyword">drop</span> 字段名;</span><br><span class="line"><span class="operator">*</span> 修改数据类型(modify)</span><br><span class="line">    <span class="keyword">alter table</span> 表名 modify 字段名 新数据类型;</span><br><span class="line"><span class="operator">*</span> 替换字段(change)</span><br><span class="line">    <span class="keyword">alter table</span> 表名 change 旧字段名 新字段名 新数据类型;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">e.g. </span><br><span class="line"><span class="comment">--增加字段</span></span><br><span class="line"><span class="keyword">alter table</span> hobby <span class="keyword">add</span> phone <span class="type">char</span>(<span class="number">10</span>) after price;</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除字段</span></span><br><span class="line"><span class="keyword">alter table</span> hobby <span class="keyword">drop</span> level;</span><br><span class="line"></span><br><span class="line"><span class="comment">--修改字段数据类型</span></span><br><span class="line"><span class="keyword">alter table</span> hobby modify phone <span class="type">char</span>(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--替换字段</span></span><br><span class="line"><span class="keyword">alter table</span> hobby change phone tel <span class="type">char</span>(<span class="number">16</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2-3-7-时间类型数据"><a href="#2-3-7-时间类型数据" class="headerlink" title="2.3.7 时间类型数据"></a>2.3.7 时间类型数据</h4><ul>
<li>日期 ： DATE</li>
<li>日期时间： DATETIME，TIMESTAMP</li>
<li>时间： TIME</li>
<li>年份 ：YEAR</li>
</ul>
<p><img src="/./img/shijian.png"></p>
<ul>
<li><p>时间格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">date</span> ：&quot;YYYY-MM-DD&quot;</span><br><span class="line"><span class="type">time</span> ：&quot;HH:MM:SS&quot;</span><br><span class="line">datetime ：&quot;YYYY-MM-DD HH:MM:SS&quot;</span><br><span class="line"><span class="type">timestamp</span> ：&quot;YYYY-MM-DD HH:MM:SS&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">create table</span> marathon (</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">athlete <span class="type">varchar</span>(<span class="number">32</span>),</span><br><span class="line">birthday <span class="type">date</span>,</span><br><span class="line">r_time datetime comment &quot;报名时间&quot;,</span><br><span class="line">performance <span class="type">time</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> marathon <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,&quot;曹操&quot;,&quot;1998-2-16&quot;,&quot;2021/5/6 10:10:27&quot;,&quot;2:38:49&quot;),</span><br><span class="line">(<span class="number">2</span>,&quot;关羽&quot;,&quot;2000-7-19&quot;,&quot;2021/4/30 16:22:09&quot;,&quot;2:27:18&quot;),</span><br><span class="line">(<span class="number">3</span>,&quot;孙策&quot;,&quot;1995-10-23&quot;,&quot;2021/5/2 20:1:2&quot;,&quot;2:44:00&quot;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li><p>日期时间函数</p>
<ul>
<li>now()  返回服务器当前日期时间,格式对应datetime类型</li>
</ul>
</li>
<li><p>时间操作</p>
<p>时间类型数据可以进行比较和排序等操作，在写时间字符串时尽量按照标准格式书写。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> marathon <span class="keyword">where</span> birthday<span class="operator">&gt;=</span><span class="string">&#x27;2000-01-01&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> marathon <span class="keyword">where</span> birthday<span class="operator">&gt;=</span>&quot;2000-07-01&quot; <span class="keyword">and</span> performance<span class="operator">&lt;=</span>&quot;2:30:00&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">练习 使用book表</span><br><span class="line"><span class="number">1.</span> 将呐喊的价格修改为<span class="number">45</span>元</span><br><span class="line"><span class="number">2.</span> 增加一个字段出版时间 类型为 <span class="type">date</span> 放在价格后面</span><br><span class="line"><span class="number">3.</span> 修改所有老舍的作品出版时间为 <span class="number">2018</span><span class="number">-10</span><span class="number">-1</span></span><br><span class="line"><span class="number">4.</span> 修改所有中国文学出版社出版的但是不是老舍的作品出版时间为 <span class="number">2020</span><span class="number">-1</span><span class="number">-1</span></span><br><span class="line"><span class="number">5.</span> 修改所有出版时间为<span class="keyword">Null</span>的图书 出版时间为 <span class="number">2019</span><span class="number">-10</span><span class="number">-1</span></span><br><span class="line"><span class="number">6.</span> 所有鲁迅的图书价格增加<span class="number">5</span>元</span><br><span class="line"><span class="number">7.</span> 删除所有价格超过<span class="number">70</span>元或者不到<span class="number">40</span>元的图书</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>将呐喊的价格修改为<span class="number">45</span>元</span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> price<span class="operator">=</span><span class="number">45</span> <span class="keyword">where</span> bname<span class="operator">=</span>&quot;呐喊&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>增加一个字段出版时间 类型为 <span class="type">date</span> 放在价格后面</span><br><span class="line"><span class="keyword">alter table</span> books</span><br><span class="line"><span class="keyword">add</span> p_time <span class="type">date</span> comment &quot;出版时间&quot; after price;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>修改所有老舍的作品出版时间为 <span class="number">2018</span><span class="number">-10</span><span class="number">-1</span></span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> p_time<span class="operator">=</span>&quot;2018-10-1&quot;</span><br><span class="line"><span class="keyword">where</span> author<span class="operator">=</span>&quot;老舍&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>修改所有中国文学出版社出版的但是不是老舍的作品</span><br><span class="line">出版时间为 <span class="number">2020</span><span class="number">-1</span><span class="number">-1</span></span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> p_time<span class="operator">=</span>&quot;2020-1-1&quot;</span><br><span class="line"><span class="keyword">where</span> press<span class="operator">=</span>&quot;中国文学出版社&quot; <span class="keyword">and</span> author<span class="operator">!=</span>&quot;老舍&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>修改所有出版时间为<span class="keyword">Null</span>的图书出版时间为<span class="number">2019</span><span class="number">-10</span><span class="number">-1</span></span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> p_time<span class="operator">=</span>&quot;2019-10-1&quot;</span><br><span class="line"><span class="keyword">where</span> p_time <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>所有鲁迅的图书价格增加<span class="number">5</span>元</span><br><span class="line"><span class="keyword">update</span> books <span class="keyword">set</span> price<span class="operator">=</span>price<span class="operator">+</span><span class="number">5</span></span><br><span class="line"><span class="keyword">where</span> author<span class="operator">=</span>&quot;鲁迅&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span>删除所有价格超过<span class="number">70</span>元或者不到<span class="number">40</span>元的图书</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> books <span class="keyword">where</span> price <span class="keyword">not</span> <span class="keyword">between</span> <span class="number">40</span> <span class="keyword">and</span> <span class="number">70</span>;</span><br></pre></td></tr></table></figure>



<h2 id="3-高级查询语句"><a href="#3-高级查询语句" class="headerlink" title="3. 高级查询语句"></a>3. 高级查询语句</h2><h3 id="3-1-模糊查询"><a href="#3-1-模糊查询" class="headerlink" title="3.1 模糊查询"></a>3.1 模糊查询</h3><p>LIKE用于在where子句中进行模糊查询，SQL LIKE 子句中使用百分号<code> %</code>来表示任意0个或多个字符，下划线<code>_</code>表示任意一个字符。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN </span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> field1 <span class="keyword">LIKE</span> condition1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e.g. </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> name <span class="keyword">like</span> &quot;T%&quot;;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> name <span class="keyword">like</span> &quot;____&quot;;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> hobby <span class="keyword">where</span> hobby <span class="keyword">like</span> &quot;%draw%&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-as-用法"><a href="#3-2-as-用法" class="headerlink" title="3.2 as 用法"></a>3.2 as 用法</h3><p>在sql语句中as用于给字段或者表重命名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> 姓名,score <span class="keyword">as</span> 分数 <span class="keyword">from</span> class;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> cls.name,cls.score <span class="keyword">from</span> class <span class="keyword">as</span> cls <span class="keyword">where</span> cls.score<span class="operator">&gt;</span><span class="number">80</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-3-排序"><a href="#3-3-排序" class="headerlink" title="3.3 排序"></a>3.3 排序</h3><p>ORDER BY 子句来设定你想按哪个字段哪种方式来进行排序，再返回搜索结果。</p>
<p>使用 ORDER BY 子句将查询数据排序后再返回数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1, field2,...fieldN <span class="keyword">from</span> table_name1 <span class="keyword">where</span> field1</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> field1 [<span class="keyword">ASC</span> [<span class="keyword">DESC</span>]]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>默认情况ASC表示升序，DESC表示降序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> score;</span><br></pre></td></tr></table></figure>

<p>复合排序：对多个字段排序，即当第一排序项相同时按照第二排序项排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">order</span> <span class="keyword">by</span> age,score <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-限制"><a href="#3-4-限制" class="headerlink" title="3.4 限制"></a>3.4 限制</h3><p>LIMIT 子句用于限制由 SELECT 语句返回的数据数量 或者 UPDATE,DELETE语句的操作数量</p>
<p>带有 LIMIT 子句的 SELECT 语句的基本语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1, column2, columnN </span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> field</span><br><span class="line">LIMIT [num] [<span class="keyword">OFFSET</span> num]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> class <span class="keyword">set</span> score<span class="operator">=</span><span class="number">83</span> limit <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--男生第一名</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span> limit <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--男生第二名</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span> limit <span class="number">1</span> <span class="keyword">offset</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h3 id="3-5-联合查询"><a href="#3-5-联合查询" class="headerlink" title="3.5 联合查询"></a>3.5 联合查询</h3><p>UNION 操作符用于连接两个以上的 SELECT 语句的结果组合到一个结果集合中。多个 SELECT 	语句会删除重复的数据。</p>
<p>UNION 操作符语法格式：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions]</span><br><span class="line"><span class="keyword">UNION</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>]</span><br><span class="line"><span class="keyword">SELECT</span> expression1, expression2, ... expression_n</span><br><span class="line"><span class="keyword">FROM</span> tables</span><br><span class="line">[<span class="keyword">WHERE</span> conditions];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>默认UNION后卫 DISTINCT表示删除结果集中重复的数据。如果使用ALL则返回所有结果集，	包含重复数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--分数大于80的男生和分数大于90的女生</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> score<span class="operator">&gt;</span><span class="number">80</span> <span class="keyword">and</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> score<span class="operator">&gt;</span><span class="number">90</span> <span class="keyword">and</span> sex<span class="operator">=</span><span class="string">&#x27;w&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--可以查询不同字段，但是字段数量必须一直</span></span><br><span class="line"><span class="keyword">select</span> name,age,score <span class="keyword">from</span> class <span class="keyword">where</span> score<span class="operator">&gt;</span><span class="number">80</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> name,hobby,price <span class="keyword">from</span> hobby;</span><br><span class="line"></span><br><span class="line"><span class="comment">--all表示如果查询结果有重复不去重，</span></span><br><span class="line"><span class="comment">--order by只能加在最后表示对union结果一起排序</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> score<span class="operator">&gt;</span><span class="number">80</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> score;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="3-7-子查询"><a href="#3-7-子查询" class="headerlink" title="3.7 子查询"></a>3.7 子查询</h3><ul>
<li><p>定义 ： 当一个select 查询语句使用（）括起来，放在其他sql语句中，作为其他sql语句的一部分是，即是一个子查询语句。</p>
</li>
<li><p>子查询使用位置：</p>
<ol>
<li>from 之后 ，此时子查询的内容作为一个新的表内容，再进行外层select查询</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span>) <span class="keyword">as</span> man </span><br><span class="line"><span class="keyword">where</span> score <span class="operator">&gt;</span> <span class="number">80</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：  需要将子查询结果集重命名一下，方便where子句中的引用操作</p>
</blockquote>
<ol start="2">
<li>where子句中，此时select查询到的内容作为外层查询的条件值</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">--查询与tom同岁的学生</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class</span><br><span class="line"><span class="keyword">where</span> age<span class="operator">=</span>(<span class="keyword">select</span> age <span class="keyword">from</span> class <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;Tom&#x27;</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment">--class  表中 谁报了兴趣爱好班</span></span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class</span><br><span class="line">  <span class="keyword">where</span> name <span class="keyword">in</span> (<span class="keyword">select</span> name <span class="keyword">from</span> hobby);</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注意：</span><br><span class="line">1. 子句结果作为一个值使用时，返回的结果需要一个明确值，不能是多行或者多列。</span><br><span class="line">2. 如果子句结果作为一个集合使用，即where子句中是in操作，则结果可以是一个字段的多个记录。</span><br></pre></td></tr></table></figure>

<ul>
<li>查询过程</li>
</ul>
<p>通过之前的学习看到，一个完整的select语句内容是很丰富的。下面看一下select的执行过程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(5)SELECT DISTINCT &lt;select_list&gt;                     </span><br><span class="line"></span><br><span class="line">(1)FROM &lt;left_table&gt; &lt;join_type&gt; JOIN &lt;right_table&gt; ON &lt;on_predicate&gt;</span><br><span class="line"></span><br><span class="line">(2)WHERE &lt;where_predicate&gt;</span><br><span class="line"></span><br><span class="line">(3)GROUP BY &lt;group_by_specification&gt;</span><br><span class="line"></span><br><span class="line">(4)HAVING &lt;having_predicate&gt;</span><br><span class="line"></span><br><span class="line">(6)ORDER BY &lt;order_by_list&gt;</span><br><span class="line"></span><br><span class="line">(7)LIMIT &lt;limit_number&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">高级查询练习</span><br><span class="line"></span><br><span class="line">在stu下创建数据报表 sanguo</span><br><span class="line"></span><br><span class="line">字段：id  name  gender  country  attack  defense</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> sanguo(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">gender enum(<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">country enum(<span class="string">&#x27;魏&#x27;</span>,<span class="string">&#x27;蜀&#x27;</span>,<span class="string">&#x27;吴&#x27;</span>),</span><br><span class="line">attack <span class="type">smallint</span>,</span><br><span class="line">defense tinyint</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> sanguo</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;曹操&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;魏&#x27;</span>, <span class="number">256</span>, <span class="number">63</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;张辽&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;魏&#x27;</span>, <span class="number">328</span>, <span class="number">69</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;甄姬&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;魏&#x27;</span>, <span class="number">168</span>, <span class="number">34</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;夏侯渊&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;魏&#x27;</span>, <span class="number">366</span>, <span class="number">83</span>),</span><br><span class="line">       (<span class="number">5</span>, <span class="string">&#x27;刘备&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;蜀&#x27;</span>, <span class="number">220</span>, <span class="number">59</span>),</span><br><span class="line">       (<span class="number">6</span>, <span class="string">&#x27;诸葛亮&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;蜀&#x27;</span>, <span class="number">170</span>, <span class="number">54</span>),</span><br><span class="line">       (<span class="number">7</span>, <span class="string">&#x27;赵云&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;蜀&#x27;</span>, <span class="number">377</span>, <span class="number">66</span>),</span><br><span class="line">       (<span class="number">8</span>, <span class="string">&#x27;张飞&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;蜀&#x27;</span>, <span class="number">370</span>, <span class="number">80</span>),</span><br><span class="line">       (<span class="number">9</span>, <span class="string">&#x27;孙尚香&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;蜀&#x27;</span>, <span class="number">249</span>, <span class="number">62</span>),</span><br><span class="line">       (<span class="number">10</span>, <span class="string">&#x27;大乔&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;吴&#x27;</span>, <span class="number">190</span>, <span class="number">44</span>),</span><br><span class="line">       (<span class="number">11</span>, <span class="string">&#x27;小乔&#x27;</span>, <span class="string">&#x27;女&#x27;</span>, <span class="string">&#x27;吴&#x27;</span>, <span class="number">188</span>, <span class="number">39</span>),</span><br><span class="line">       (<span class="number">12</span>, <span class="string">&#x27;周瑜&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;吴&#x27;</span>, <span class="number">303</span>, <span class="number">60</span>),</span><br><span class="line">       (<span class="number">13</span>, <span class="string">&#x27;吕蒙&#x27;</span>, <span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;吴&#x27;</span>, <span class="number">330</span>, <span class="number">71</span>);</span><br><span class="line"></span><br><span class="line">查找练习</span><br><span class="line"><span class="number">1.</span> 查找所有蜀国人信息，按照攻击力排名</span><br><span class="line"><span class="number">2.</span> 吴国英雄攻击力超过<span class="number">300</span>的改为<span class="number">300</span>，最多改<span class="number">2</span>个</span><br><span class="line"><span class="number">3.</span> 查找攻击力超过<span class="number">200</span>的魏国英雄名字和攻击力并显示为姓名， 攻击力</span><br><span class="line"><span class="number">4.</span> 所有英雄按照攻击力降序排序，如果相同则按照防御生序排序</span><br><span class="line"><span class="number">5.</span> 查找名字为<span class="number">3</span>字的</span><br><span class="line"><span class="number">6.</span> 找到魏国防御力排名<span class="number">2</span><span class="number">-3</span>名的英雄</span><br><span class="line"><span class="number">7.</span> 查找所有女性角色中攻击力大于<span class="number">180</span>的和男性中攻击力小于<span class="number">250</span>的</span><br><span class="line"><span class="number">8.</span> 查找攻击力比魏国最高攻击力的人还要高的蜀国英雄</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 查找所有蜀国人信息，按照攻击力排名</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">where</span> country<span class="operator">=</span>&quot;蜀&quot;</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> attack <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 吴国英雄攻击力超过<span class="number">300</span>的改为<span class="number">300</span>，最多改<span class="number">2</span>个</span><br><span class="line"><span class="keyword">update</span> sanguo <span class="keyword">set</span> attack<span class="operator">=</span><span class="number">300</span></span><br><span class="line"><span class="keyword">where</span> country<span class="operator">=</span>&quot;吴&quot; <span class="keyword">and</span> attack<span class="operator">&gt;</span><span class="number">300</span></span><br><span class="line">limit <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 查找攻击力超过<span class="number">200</span>的魏国英雄名字和攻击力并显示为姓名， 攻击力</span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> 姓名,attack <span class="keyword">as</span> 攻击力</span><br><span class="line"><span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">where</span> attack<span class="operator">&gt;</span><span class="number">200</span> <span class="keyword">and</span> country<span class="operator">=</span>&quot;魏&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 所有英雄按照攻击力降序排序，如果相同则按照防御生序排序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> attack <span class="keyword">desc</span>,defense;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 查找名字为<span class="number">3</span>字的</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo <span class="keyword">where</span> name <span class="keyword">like</span> &quot;___&quot;;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> 找到魏国防御力排名<span class="number">2</span><span class="number">-3</span>名的英雄</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">where</span> country<span class="operator">=</span>&quot;魏&quot;</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> defense <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">2</span> <span class="keyword">offset</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span> 查找所有女性角色中攻击力大于<span class="number">180</span>的和男性中攻击力小于<span class="number">250</span>的</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo <span class="keyword">where</span> gender<span class="operator">=</span>&quot;女&quot; <span class="keyword">and</span> attack<span class="operator">&gt;</span><span class="number">180</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo <span class="keyword">where</span> gender<span class="operator">=</span>&quot;男&quot; <span class="keyword">and</span> attack<span class="operator">&lt;</span><span class="number">250</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span> 查找攻击力比魏国最高攻击力的人还要高的蜀国英雄</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">where</span> country<span class="operator">=</span>&quot;蜀&quot; <span class="keyword">and</span></span><br><span class="line"> attack <span class="operator">&gt;</span> (<span class="keyword">select</span> attack <span class="keyword">from</span> sanguo</span><br><span class="line"><span class="keyword">where</span> country<span class="operator">=</span>&quot;魏&quot; <span class="keyword">order</span> <span class="keyword">by</span> attack <span class="keyword">desc</span></span><br><span class="line">limit <span class="number">1</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="4-聚合操作"><a href="#4-聚合操作" class="headerlink" title="4. 聚合操作"></a>4. 聚合操作</h2><p>聚合操作指的是在数据查找基础上对数据的进一步整理筛选行为，实际上聚合操作也属于数据的查询筛选范围。</p>
<h3 id="4-1-聚合函数"><a href="#4-1-聚合函数" class="headerlink" title="4.1 聚合函数"></a>4.1 聚合函数</h3><table>
<thead>
<tr>
<th>方法</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>avg(字段名)</td>
<td>该字段的平均值</td>
</tr>
<tr>
<td>max(字段名)</td>
<td>该字段的最大值</td>
</tr>
<tr>
<td>min(字段名)</td>
<td>该字段的最小值</td>
</tr>
<tr>
<td>sum(字段名)</td>
<td>该字段所有记录的和</td>
</tr>
<tr>
<td>count(字段名)</td>
<td>统计该字段记录的个数</td>
</tr>
</tbody></table>
<p>eg1 : 找出表中的最大攻击力的值？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select max(attack) from sanguo;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>eg2 : 表中共有多少个英雄？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select count(name) as number from sanguo;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>eg3 : 蜀国英雄中攻击值大于200的英雄的数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from sanguo where attack &gt; 200; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意： 此时select 后只能写聚合函数，无法查找其他字段，除非该字段值全都一样。</p>
</blockquote>
<h3 id="4-2-聚合分组"><a href="#4-2-聚合分组" class="headerlink" title="4.2 聚合分组"></a>4.2 聚合分组</h3><ul>
<li><strong>group by</strong></li>
</ul>
<p>给查询的结果进行分组</p>
<p>e.g.  : 计算每个国家的平均攻击力</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select country,avg(attack) from sanguo group by country;</span><br></pre></td></tr></table></figure>

<p>e.g. :  对多个字段创建分组，此时多个字段都相同时为一组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--统计每个国家男性英雄和女性英雄的平均攻击力</span><br><span class="line">select country,gender,avg(attack) from sanguo</span><br><span class="line">group by country,gender;</span><br></pre></td></tr></table></figure>

<p>e.g. : 所有国家的男英雄中 英雄数量最多的前2名的 国家名称及英雄数量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select country,count(id) as number from sanguo </span><br><span class="line">where gender=&#x27;男&#x27; group by country</span><br><span class="line">order by number DESC</span><br><span class="line">limit 2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意： 使用分组时select 后的字段为group by分组的字段和聚合函数，不能包含其他内容。group by也可以同时依照多个字段分组，如group by A，B 此时必须A,B两个字段值均相同才算一组。</p>
</blockquote>
<h3 id="4-3-聚合筛选"><a href="#4-3-聚合筛选" class="headerlink" title="4.3 聚合筛选"></a>4.3 聚合筛选</h3><ul>
<li><strong>having语句</strong></li>
</ul>
<p>对分组聚合后的结果进行进一步筛选</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--统计平均攻击力大于250的国家的英雄数量</span><br><span class="line">select country,count(*) from sanguo</span><br><span class="line">group by country</span><br><span class="line">having avg(attack)&gt;250;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意</p>
<ol>
<li>having语句通常与group by联合使用作为组的筛选。</li>
<li>having语句存在弥补了where关键字不能与聚合函数联合使用的不足,where只能操作表中实际存在的字段。</li>
</ol>
</blockquote>
<h3 id="4-4-去重语句"><a href="#4-4-去重语句" class="headerlink" title="4.4 去重语句"></a>4.4 去重语句</h3><ul>
<li><strong>distinct语句</strong></li>
</ul>
<p>不显示字段重复值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eg1 : 表中都有哪些国家</span><br><span class="line">  select distinct country from sanguo;</span><br><span class="line">eg2 : 计算一共有多少个国家</span><br><span class="line">  select count(distinct country) from sanguo;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意: distinct和from之间所有字段都相同才会去重  </p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">聚合练习</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 统计每位作家出版图书的平均价格</span><br><span class="line"><span class="number">2.</span> 统计每个出版社出版图书数量</span><br><span class="line"><span class="number">3.</span> 统计同一时间出版图书的最高价格和最低价格</span><br><span class="line"><span class="number">4.</span> 筛选出那些出版过超过<span class="number">50</span>元图书的出版社，并按照其出版图书的平均价格降序排序</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 统计每位作家出版图书的平均价格</span><br><span class="line"><span class="keyword">select</span> author,<span class="built_in">avg</span>(price) <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> author;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 统计每个出版社出版图书数量</span><br><span class="line"><span class="keyword">select</span> press,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> press;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 统计同一时间出版图书的最高价格和最低价格</span><br><span class="line"><span class="keyword">select</span> p_time,<span class="built_in">max</span>(price),<span class="built_in">min</span>(price) <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> p_time;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 筛选出那些出版过超过<span class="number">50</span>元图书的出版社，</span><br><span class="line">并按照其出版图书的平均价格降序排序</span><br><span class="line"><span class="keyword">select</span> press,<span class="built_in">avg</span>(price) <span class="keyword">from</span> books</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> press</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">max</span>(price) <span class="operator">&gt;</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">avg</span>(price) <span class="keyword">desc</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="5-索引操作"><a href="#5-索引操作" class="headerlink" title="5. 索引操作"></a>5. 索引操作</h2><h3 id="5-1-概述"><a href="#5-1-概述" class="headerlink" title="5.1 概述"></a>5.1 概述</h3><ul>
<li><strong>定义</strong></li>
</ul>
<p>索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可快速访问数据库表中的特定信息。</p>
<ul>
<li><strong>优缺点</strong><ul>
<li>优点 ： 加快数据检索速度,提高查找效率</li>
<li>缺点 ：占用数据库物理存储空间，当对表中数据更新时,索引需要动态维护,降低数据写入效率</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意 ： </p>
<ol>
<li>通常我们只在经常进行查询操作的字段上创建索引</li>
<li>对于数据量很少的表或者经常进行写操作而不是查询操作的表不适合创建索引</li>
</ol>
</blockquote>
<h3 id="5-2-索引分类"><a href="#5-2-索引分类" class="headerlink" title="5.2 索引分类"></a>5.2 索引分类</h3><ul>
<li>普通(MUL)</li>
</ul>
<blockquote>
<p>普通索引 ：字段值无约束,KEY标志为 MUL</p>
</blockquote>
<ul>
<li>唯一索引(UNI)</li>
</ul>
<blockquote>
<p>唯一索引(unique) ：字段值不允许重复,但可为 NULL,KEY标志为 UNI</p>
</blockquote>
<ul>
<li>主键索引（PRI）</li>
</ul>
<blockquote>
<p>一个表中只能有一个主键字段, 主键字段不允许重复,且不能为NULL，KEY标志为PRI。通常设置记录编号字段id,能唯一锁定一条记录</p>
</blockquote>
<h3 id="5-3-索引创建"><a href="#5-3-索引创建" class="headerlink" title="5.3 索引创建"></a>5.3 索引创建</h3><ul>
<li>创建表时直接创建索引</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line">字段名 数据类型，</span><br><span class="line">字段名 数据类型，</span><br><span class="line">index 索引名(字段名)，</span><br><span class="line">unique 索引名(字段名)，</span><br><span class="line">primary key(字段名)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="comment">-- 创建表同时添加索引</span></span><br><span class="line"><span class="keyword">create table</span> index_test (</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line"><span class="keyword">unique</span> nameIndex(name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<ul>
<li>在已有表中创建索引：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create [unique] index 索引名 on 表名(字段名);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">create</span> index nameIndex <span class="keyword">on</span> class(name);</span><br></pre></td></tr></table></figure>

<ul>
<li>主键索引添加</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> 表名 <span class="keyword">add</span> <span class="keyword">primary key</span>(id);</span><br></pre></td></tr></table></figure>

<ul>
<li>查看索引</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. desc 表名;  --&gt; KEY标志为：MUL 、UNI。</span><br><span class="line">2. show index from 表名;</span><br></pre></td></tr></table></figure>

<ul>
<li>删除索引</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop index 索引名 on 表名;</span><br><span class="line">alter table 表名 drop primary key;  # 删除主键</span><br></pre></td></tr></table></figure>

<ul>
<li>扩展： 借助性能查看选项去查看索引性能</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span>  profiling <span class="operator">=</span> <span class="number">1</span>； 打开功能 （项目上线一般不打开）</span><br><span class="line"><span class="keyword">show</span> profiles  查看语句执行信息</span><br></pre></td></tr></table></figure>



<h2 id="6-外键约束和表关联关系"><a href="#6-外键约束和表关联关系" class="headerlink" title="6. 外键约束和表关联关系"></a>6. 外键约束和表关联关系</h2><h3 id="6-1-外键约束"><a href="#6-1-外键约束" class="headerlink" title="6.1 外键约束"></a>6.1 外键约束</h3><ul>
<li>约束 : 约束是一种限制，它通过对表的行或列的数据做出限制，来确保表的数据的完整性、关联性</li>
<li>foreign key 功能 : 建立表与表之间的某种约束的关系，由于这种关系的存在，能够让表与表之间的数据，更加的完整，关连性更强，为了具体说明创建如下部门表和人员表。</li>
<li>示例</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> dept (id <span class="type">int</span> <span class="keyword">PRIMARY KEY</span> auto_increment,dname <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">not null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> dept <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,&quot;技术部&quot;),</span><br><span class="line">(<span class="number">2</span>,&quot;销售部&quot;),</span><br><span class="line">(<span class="number">3</span>,&quot;市场部&quot;),</span><br><span class="line">(<span class="number">4</span>,&quot;行政部&quot;),</span><br><span class="line">(<span class="number">5</span>,<span class="string">&#x27;财务部&#x27;</span>),</span><br><span class="line">(<span class="number">6</span>,<span class="string">&#x27;总裁办公室&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建人员表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> person (</span><br><span class="line">  id <span class="type">int</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">  age tinyint unsigned,</span><br><span class="line">  salary <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>),</span><br><span class="line">  dept_id <span class="type">int</span></span><br><span class="line">) ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> person <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,&quot;Lily&quot;,<span class="number">29</span>,<span class="number">20000</span>,<span class="number">2</span>),</span><br><span class="line">(<span class="number">2</span>,&quot;Tom&quot;,<span class="number">27</span>,<span class="number">16000</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="number">3</span>,&quot;Joy&quot;,<span class="number">30</span>,<span class="number">28000</span>,<span class="number">1</span>),</span><br><span class="line">(<span class="number">4</span>,&quot;Emma&quot;,<span class="number">24</span>,<span class="number">8000</span>,<span class="number">4</span>),</span><br><span class="line">(<span class="number">5</span>,&quot;Abby&quot;,<span class="number">28</span>,<span class="number">17000</span>,<span class="number">3</span>),</span><br><span class="line">(<span class="number">6</span>,&quot;Jame&quot;,<span class="number">32</span>,<span class="number">22000</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>上面两个表中每个人员都应该有指定的部门，但是实际上在没有约束的情况下人员是可以没有部门的或者也可以添加一个不存在的部门，这显然是不合理的。</p>
<ul>
<li><p>主表和从表：若同一个数据库中，B表的外键与A表的主键相对应，则A表为主表，B表为从表。</p>
</li>
<li><p>foreign key 外键的定义语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">CONSTRAINT</span> symbol] <span class="keyword">FOREIGN KEY</span>（外键字段） </span><br><span class="line"></span><br><span class="line"><span class="keyword">REFERENCES</span> tbl_name (主表主键)</span><br><span class="line"></span><br><span class="line">[<span class="keyword">ON</span> <span class="keyword">DELETE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION&#125;]</span><br><span class="line"></span><br><span class="line">[<span class="keyword">ON</span> <span class="keyword">UPDATE</span> &#123;RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION&#125;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>该语法可以在 CREATE TABLE 和 ALTER TABLE 时使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表时直接建立外键</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> person (</span><br><span class="line">id <span class="type">int</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">age tinyint unsigned,</span><br><span class="line">salary <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">dept_id <span class="type">int</span> ,</span><br><span class="line"><span class="keyword">constraint</span> dept_fk <span class="keyword">foreign key</span>(dept_id) <span class="keyword">references</span> dept(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<p>建立表后增加外键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> person <span class="keyword">add</span></span><br><span class="line"><span class="keyword">constraint</span> dept_fk</span><br><span class="line"><span class="keyword">foreign key</span>(dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<ol>
<li>并不是任何情况表关系都需要建立外键来约束，如果没有类似上面的约束关系时也可以不建立。</li>
<li>从表的外键字段数据类型与指定的主表主键应该相同。</li>
</ol>
</blockquote>
<ul>
<li><p>通过外键名称解除外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> person <span class="keyword">drop</span> <span class="keyword">foreign key</span> dept_fk;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看外键名称</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create table</span> person;</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>注意：删除外键后发现desc查看索引标志还在，其实外键也是一种索引，需要将外键名称的索引删除之后才可以。</p>
</blockquote>
<ul>
<li><p>级联动作</p>
<ul>
<li><p>restrict(默认)  :  on delete restrict  on update restrict</p>
<ul>
<li>当主表删除记录时，如果从表中有相关联记录则不允许主表删除</li>
<li>当主表更改主键字段值时，如果从表有相关记录则不允许更改</li>
</ul>
</li>
<li><p>cascade ：数据级联更新  on delete cascade   on update cascade</p>
<ul>
<li><p>当主表删除记录或更改被参照字段的值时,从表会级联更新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> person <span class="keyword">add</span></span><br><span class="line"><span class="keyword">constraint</span> dept_fk</span><br><span class="line"><span class="keyword">foreign key</span>(dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">delete</span> cascade <span class="keyword">on</span> <span class="keyword">update</span> cascade;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>set null  :   on delete set null    on update set null</p>
<ul>
<li><p>当主表删除记录时，从表外键字段值变为null</p>
</li>
<li><p>当主表更改主键字段值时，从表外键字段值变为null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter table</span> person <span class="keyword">add</span></span><br><span class="line"><span class="keyword">constraint</span> dept_fk</span><br><span class="line"><span class="keyword">foreign key</span>(dept_id)</span><br><span class="line"><span class="keyword">references</span> dept(id)</span><br><span class="line"><span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">set</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">set</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="6-2-表关联关系"><a href="#6-2-表关联关系" class="headerlink" title="6.2 表关联关系"></a>6.2 表关联关系</h3><p>当我们应对复杂的数据关系的时候，数据表的设计就显得尤为重要，认识数据之间的依赖关系是更加合理创建数据表关联性的前提。一对多和多对多是常见的表数据关系：</p>
<ul>
<li>一对多关系</li>
</ul>
<blockquote>
<p>一张表中有一条记录可以对应另外一张表中的多条记录；但是反过来，另外一张表的一条记录<br>只能对应第一张表的一条记录，这种关系就是一对多或多对一</p>
<p>举例： 一个人可以拥有多辆汽车，每辆车登记的车主只有一人。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> people(</span><br><span class="line">id <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">primary key</span>,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">age <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> car(</span><br><span class="line">id <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">primary key</span>,</span><br><span class="line">brand <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">price <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">pid <span class="type">varchar</span>(<span class="number">32</span>),</span><br><span class="line"><span class="keyword">foreign key</span>(pid) <span class="keyword">references</span> people(id)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>多对多关系</li>
</ul>
<blockquote>
<p>一对表中（A）的一条记录能够对应另外一张表（B）中的多条记录；同时B表中的一条记录<br>也能对应A表中的多条记录</p>
<p>举例：一个运动员可以报多个项目，每个项目也会有多个运动员参加,这时为了表达多对多关系需要单独创建关系表。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE athlete (</span><br><span class="line">  id int primary key AUTO_INCREMENT,</span><br><span class="line">  name varchar(30),</span><br><span class="line">  age tinyint NOT NULL,</span><br><span class="line">  country varchar(30) NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE sports (</span><br><span class="line">  id int primary key AUTO_INCREMENT,</span><br><span class="line">  sport varchar(30) NOT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE athlete_sports (</span><br><span class="line">   id int primary key auto_increment,</span><br><span class="line">   aid int NOT NULL,</span><br><span class="line">   sid int NOT NULL,</span><br><span class="line">   FOREIGN KEY (aid) REFERENCES athlete (id),</span><br><span class="line">   FOREIGN KEY (sid) REFERENCES sports (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 关系表中添加排名字段</span><br><span class="line">alter table athlete_item add ranking int after tid;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">表关系设计练习：</span><br><span class="line">根据所学 用户朋友圈表内容表，使其合理，假设现有如下内容需要存储：</span><br><span class="line">姓名  密码  电话  图片 内容  地点 时间 点赞  评论</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> <span class="keyword">user</span>(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">passwd <span class="type">char</span>(<span class="number">64</span>),</span><br><span class="line">tel <span class="type">char</span>(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> friends(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">image <span class="type">char</span>(<span class="number">50</span>),</span><br><span class="line">content <span class="type">varchar</span>(<span class="number">1024</span>),</span><br><span class="line"><span class="type">time</span> datetime ,</span><br><span class="line">address <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">user_id <span class="type">int</span> ,</span><br><span class="line"><span class="keyword">foreign key</span>(user_id) <span class="keyword">references</span> <span class="keyword">user</span>(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> like_comment(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">`<span class="keyword">like</span>` bit,</span><br><span class="line">comment text,</span><br><span class="line">user_id <span class="type">int</span> ,</span><br><span class="line">friends_id <span class="type">int</span> ,</span><br><span class="line"><span class="keyword">foreign key</span>(user_id) <span class="keyword">references</span> <span class="keyword">user</span>(id),</span><br><span class="line"><span class="keyword">foreign key</span>(friends_id) <span class="keyword">references</span> friends(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="6-3-E-R模型图"><a href="#6-3-E-R模型图" class="headerlink" title="6.3 E-R模型图"></a>6.3 E-R模型图</h3><ul>
<li><strong>定义</strong></li>
</ul>
<p>		</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">E-R模型(Entry-Relationship)即 实体-关系 数据模型,用于数据库设计</span><br><span class="line">用简单的图(E-R图)反映了现实世界中存在的事物或数据以及他们之间的关系</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>实体、属性、关系</strong></li>
</ul>
<p>​	实体</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、描述客观事物的概念</span><br><span class="line">2、表示方法 ：矩形框</span><br><span class="line">3、示例 ：一个人、一本书、一杯咖啡、一个学生</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​	属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、实体具有的某种特性</span><br><span class="line">2、表示方法 ：椭圆形</span><br><span class="line">3、示例</span><br><span class="line">   学生属性 ：学号、姓名、年龄、性别、专业 ... </span><br><span class="line">   感受属性 ：悲伤、喜悦、刺激、愤怒 ...</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​	关系</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、实体之间的联系</span><br><span class="line">2、一对多关联(1:n)</span><br><span class="line">3、多对多关联(m:n) </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>E-R图的绘制</strong></li>
</ul>
<p>矩形框代表实体,菱形框代表关系,椭圆形代表属性</p>
<p><img src="/./img/er.PNG"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">表关系设计练习：</span><br><span class="line"><span class="number">1.</span> 有一个课程管理系统，特征如下：一个学院可以开设多门课程，但是一门课程只能在一个学院开设，一个学生可以选修多门课程，每个课程可以供多个学生选修，一名教师可以教一门课程，但是一门课程可以有多为教师讲授，每个学院可聘用多名名教师，但是一个教师只能在一个学院任职，要求该系统能够查询到任何一个学生某一门课的成绩，及这个学生的这门课是哪个老师教的。 画出E<span class="operator">-</span>R图分析表关系即可</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、 将book表拆分为三张表（图书   作家    出版社）,自行设计表之间的关系，通过E<span class="operator">-</span>R图分析表关系和属性，然后写出创建语句</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> author(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">sex <span class="type">char</span>,</span><br><span class="line">age tinyint</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> press(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">pname <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">tel <span class="type">char</span>(<span class="number">16</span>),</span><br><span class="line">address <span class="type">varchar</span>(<span class="number">512</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> book(</span><br><span class="line">id <span class="type">char</span>(<span class="number">18</span>) <span class="keyword">primary key</span>,</span><br><span class="line">bname <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">price <span class="type">float</span>,</span><br><span class="line">author_id <span class="type">int</span>,</span><br><span class="line">press_id <span class="type">int</span> ,</span><br><span class="line"><span class="keyword">foreign key</span> (author_id) <span class="keyword">references</span> author(id),</span><br><span class="line"><span class="keyword">foreign key</span> (press_id) <span class="keyword">references</span> press(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> author_press(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span>,</span><br><span class="line">author_id <span class="type">int</span>,</span><br><span class="line">press_id <span class="type">int</span> ,</span><br><span class="line"><span class="keyword">foreign key</span> (author_id) <span class="keyword">references</span> author(id),</span><br><span class="line"><span class="keyword">foreign key</span> (press_id) <span class="keyword">references</span> press(id)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6-4-表关联查询"><a href="#6-4-表关联查询" class="headerlink" title="6.4 表关联查询"></a>6.4 表关联查询</h3><p>如果多个表存在一定关联关系，可以多表在一起进行查询操作，其实表的关联整理与外键约束之间并没有必然联系，但是基于外键约束设计的具有关联性的表往往会更多使用关联查询查找数据。</p>
<ul>
<li>简单多表查询</li>
</ul>
<p>多个表数据可以联合查询，语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  字段<span class="number">1</span>,字段<span class="number">2.</span>.. <span class="keyword">from</span> 表<span class="number">1</span>,表<span class="number">2.</span>.. [<span class="keyword">where</span> 条件]</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">select</span> c.name,c.score,h.hobby <span class="keyword">from</span> class <span class="keyword">as</span> c,hobby <span class="keyword">as</span> h </span><br><span class="line"><span class="keyword">where</span> c.name<span class="operator">=</span>h.name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> name,salary,dname <span class="keyword">from</span> person,dept</span><br><span class="line"><span class="keyword">where</span> person.dept_id <span class="operator">=</span> dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> name,salary,dname <span class="keyword">from</span> person,dept </span><br><span class="line"><span class="keyword">where</span> person.dept_id <span class="operator">=</span> dept.id <span class="keyword">and</span> salary<span class="operator">&gt;=</span><span class="number">20000</span>;</span><br></pre></td></tr></table></figure>

<p>笛卡尔积现象就是将A表的每一条记录与B表的每一条记录强行拼在一起。所以，如果A表有n条记录，B表有m条记录，笛卡尔积产生的结果就会产生n*m条记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class,hobby;</span><br></pre></td></tr></table></figure>

<ul>
<li>内连接</li>
</ul>
<p>内连接查询只会查找到符合条件的记录，其实结果和表关联查询是一样的,官方更推荐使用内连接查询。</p>
<p><img src="/./img/inner.PNG"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表</span><br><span class="line">    <span class="keyword">FROM</span> 表<span class="number">1</span>  <span class="keyword">INNER</span> <span class="keyword">JOIN</span>  表<span class="number">2</span></span><br><span class="line"><span class="keyword">ON</span> 表<span class="number">1.</span>字段 <span class="operator">=</span> 表<span class="number">2.</span>字段;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,salary,dname <span class="keyword">from</span> person <span class="keyword">inner</span> <span class="keyword">join</span> dept</span><br><span class="line"><span class="keyword">on</span> person.dept_id <span class="operator">=</span> dept.id</span><br><span class="line"><span class="keyword">where</span> salary<span class="operator">&gt;=</span><span class="number">20000</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>左连接  : 左表全部显示，显示右表中与左表匹配的项</li>
</ul>
<p><img src="/./img/left.PNG"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表</span><br><span class="line">    <span class="keyword">FROM</span> 表<span class="number">1</span>  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span>  表<span class="number">2</span></span><br><span class="line"><span class="keyword">ON</span> 表<span class="number">1.</span>字段 <span class="operator">=</span> 表<span class="number">2.</span>字段;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e.g. </span><br><span class="line"><span class="keyword">select</span> name,salary,dname</span><br><span class="line"><span class="keyword">from</span> person <span class="keyword">left</span> <span class="keyword">join</span> dept</span><br><span class="line"><span class="keyword">on</span> person.dept_id <span class="operator">=</span> dept.id</span><br><span class="line"><span class="keyword">where</span> salary<span class="operator">&gt;=</span><span class="number">20000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询每个部门员工人数</span></span><br><span class="line"><span class="keyword">select</span> dname,<span class="built_in">count</span>(name) <span class="keyword">from</span> dept <span class="keyword">left</span> <span class="keyword">join</span> person <span class="keyword">on</span> dept.id<span class="operator">=</span>person.dept_id <span class="keyword">group</span> <span class="keyword">by</span> dname;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>右连接 ：右表全部显示，显示左表中与右表匹配的项</li>
</ul>
<p><img src="/./img/right.PNG"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段列表</span><br><span class="line">    <span class="keyword">FROM</span> 表<span class="number">1</span>  <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span>  表<span class="number">2</span></span><br><span class="line"><span class="keyword">ON</span> 表<span class="number">1.</span>字段 <span class="operator">=</span> 表<span class="number">2.</span>字段;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e.g.</span><br><span class="line"><span class="keyword">select</span> dname,<span class="built_in">count</span>(name)</span><br><span class="line"><span class="keyword">from</span> person <span class="keyword">right</span> <span class="keyword">join</span> dept</span><br><span class="line"><span class="keyword">on</span> person.dept_id <span class="operator">=</span> dept.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> dname;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>注意：我们尽量使用数据量大的表作为基准表,放在前面。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">综合查询练习</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> class(cid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,caption <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not null</span>);</span><br><span class="line">                  </span><br><span class="line"><span class="keyword">create table</span> teacher(tid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,tname <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not null</span>);</span><br><span class="line">                    </span><br><span class="line"><span class="keyword">create table</span> student(</span><br><span class="line">    sid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">    sname <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">not null</span>,</span><br><span class="line">    gender enum(<span class="string">&#x27;male&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="string">&#x27;others&#x27;</span>) <span class="keyword">not null</span> <span class="keyword">default</span> <span class="string">&#x27;male&#x27;</span>,</span><br><span class="line">    class_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign key</span>(class_id) <span class="keyword">references</span> class(cid) </span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade);</span><br><span class="line">                    </span><br><span class="line"><span class="keyword">create table</span> course(</span><br><span class="line">    cid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">    cname <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">not null</span>,</span><br><span class="line">    teacher_id <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">foreign key</span>(teacher_id) <span class="keyword">references</span> teacher(tid)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade);</span><br><span class="line">                   </span><br><span class="line"><span class="keyword">create table</span> score(</span><br><span class="line">    sid <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line">    student_id <span class="type">int</span>,</span><br><span class="line">    course_id <span class="type">int</span>,</span><br><span class="line">    number <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">not null</span>,</span><br><span class="line">    <span class="keyword">foreign key</span>(student_id) <span class="keyword">references</span> student(sid)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade,</span><br><span class="line">    <span class="keyword">foreign key</span>(course_id) <span class="keyword">references</span> course(cid)</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade <span class="keyword">on</span> <span class="keyword">delete</span> cascade);</span><br><span class="line">                   </span><br><span class="line"><span class="keyword">insert into</span> class(caption) <span class="keyword">values</span>(<span class="string">&#x27;三年一班&#x27;</span>),(<span class="string">&#x27;三年二班&#x27;</span>),(<span class="string">&#x27;三年三班&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> teacher(tname) <span class="keyword">values</span>(<span class="string">&#x27;魏老师&#x27;</span>),(<span class="string">&#x27;祁老师&#x27;</span>),(<span class="string">&#x27;小泽老师&#x27;</span>);</span><br><span class="line"><span class="keyword">insert into</span> student(sname,gender,class_id) <span class="keyword">values</span>(<span class="string">&#x27;钢蛋&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;铁锤&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;山炮&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">2</span>),(<span class="string">&#x27;彪哥&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">3</span>),(<span class="string">&#x27;虎子&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">3</span>),(<span class="string">&#x27;妞妞&#x27;</span>,<span class="string">&#x27;female&#x27;</span>,<span class="number">2</span>),(<span class="string">&#x27;建国&#x27;</span>,<span class="string">&#x27;male&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> course(cname,teacher_id) <span class="keyword">values</span>(<span class="string">&#x27;生物&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;体育&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;物理&#x27;</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert into</span> score(student_id,course_id,number) <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">60</span>),(<span class="number">1</span>,<span class="number">2</span>,<span class="number">59</span>),(<span class="number">2</span>,<span class="number">2</span>,<span class="number">100</span>),(<span class="number">3</span>,<span class="number">2</span>,<span class="number">78</span>),(<span class="number">4</span>,<span class="number">3</span>,<span class="number">66</span>),(<span class="number">2</span>,<span class="number">3</span>,<span class="number">78</span>),(<span class="number">5</span>,<span class="number">2</span>,<span class="number">77</span>),(<span class="number">6</span>,<span class="number">1</span>,<span class="number">84</span>),(<span class="number">7</span>,<span class="number">1</span>,<span class="number">79</span>),(<span class="number">5</span>,<span class="number">3</span>,<span class="number">80</span>),(<span class="number">3</span>,<span class="number">1</span>,<span class="number">59</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 查询每位老师教授的课程数量</span><br><span class="line"><span class="number">2.</span> 查询各科成绩最高和最低的分数,形式 : 课程ID  课程名称 最高分  最低分</span><br><span class="line"><span class="number">3.</span> 查询平均成绩大于<span class="number">85</span>分的所有学生学号,姓名和平均成绩</span><br><span class="line"><span class="number">4.</span> 查询课程编号为<span class="number">2</span>且课程成绩在<span class="number">80</span>以上的学生学号和姓名</span><br><span class="line"><span class="number">5.</span> 查询各个课程及相应的选修人数</span><br><span class="line"><span class="number">6.</span> 查询每位学生的姓名，所在班级和各科平均成绩</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> 查询每位老师教授的课程数量</span><br><span class="line"><span class="keyword">select</span> tname,<span class="built_in">count</span>(cname)</span><br><span class="line"><span class="keyword">from</span> teacher <span class="keyword">left</span> <span class="keyword">join</span> course</span><br><span class="line"><span class="keyword">on</span> teacher.tid <span class="operator">=</span> course.teacher_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> tname;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 查询各科成绩最高和最低的分数,形式 : 课程ID  课程名称 最高分  最低分</span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">as</span> 课程ID,cname <span class="keyword">as</span> 课程名称,</span><br><span class="line"><span class="built_in">max</span>(number) <span class="keyword">as</span> 最高分,<span class="built_in">min</span>(number) <span class="keyword">as</span> 最低分</span><br><span class="line"><span class="keyword">from</span> course <span class="keyword">left</span> <span class="keyword">join</span> score</span><br><span class="line"><span class="keyword">on</span> course.cid <span class="operator">=</span> score.course_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cid,cname;</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 查询平均成绩大于<span class="number">85</span>分的所有学生学号,姓名和平均成绩</span><br><span class="line"><span class="keyword">select</span> student.sid,sname,<span class="built_in">avg</span>(number)</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">left</span> <span class="keyword">join</span> score</span><br><span class="line"><span class="keyword">on</span> student.sid <span class="operator">=</span> score.student_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> student.sid,sname</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(number) <span class="operator">&gt;</span> <span class="number">85</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 查询课程编号为<span class="number">2</span>且课程成绩在<span class="number">80</span>以上的学生学号和姓名</span><br><span class="line"><span class="keyword">select</span> student.sid,sname,number</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">left</span> <span class="keyword">join</span> score</span><br><span class="line"><span class="keyword">on</span> student.sid <span class="operator">=</span> score.student_id</span><br><span class="line"><span class="keyword">where</span> course_id<span class="operator">=</span><span class="number">2</span> <span class="keyword">and</span> number<span class="operator">&gt;</span><span class="number">80</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span> 查询各个课程及相应的选修人数</span><br><span class="line"><span class="keyword">select</span> cname,<span class="built_in">count</span>(course_id)</span><br><span class="line"><span class="keyword">from</span> course <span class="keyword">left</span> <span class="keyword">join</span> score</span><br><span class="line"><span class="keyword">on</span> course.cid <span class="operator">=</span> score.course_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cname;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span> 查询每位学生的姓名，所在班级和平均成绩</span><br><span class="line"><span class="keyword">select</span> sname,caption,<span class="built_in">avg</span>(number)</span><br><span class="line"><span class="keyword">from</span> student <span class="keyword">left</span> <span class="keyword">join</span> class</span><br><span class="line"><span class="keyword">on</span> student.class_id <span class="operator">=</span> class.cid</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> score</span><br><span class="line"><span class="keyword">on</span> student.sid <span class="operator">=</span> score.student_id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> sname,caption;</span><br></pre></td></tr></table></figure>



<h2 id="7-视图"><a href="#7-视图" class="headerlink" title="7. 视图"></a>7. 视图</h2><ul>
<li>视图概念</li>
</ul>
<p>视图是存储的查询语句,当调用的时候,产生结果集,视图充当的是虚拟表的角色。其实视图可以理解为一个表或多个表中导出来的表，作用和真实表一样，包含一系列带有行和列的数据 视图中，用户可以使用SELECT语句查询数据，也可以使用INSERT，UPDATE，DELETE修改记录，视图可以使用户操作方便，并保障数据库系统安全，如果原表改名或者删除则视图也失效。</p>
<ul>
<li>创建视图</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">语法结构：</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] <span class="keyword">VIEW</span> [view_name] <span class="keyword">AS</span> [SELECT_STATEMENT];</span><br><span class="line"></span><br><span class="line">释义：</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span>： 创建视图</span><br><span class="line"><span class="keyword">OR</span> REPLACE : 可选，如果添加原来有同名视图的情况下会覆盖掉原有视图</span><br><span class="line">view_name ： 视图名称</span><br><span class="line">SELECT_STATEMENT ：<span class="keyword">SELECT</span>语句</span><br><span class="line"></span><br><span class="line">e.g.</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> good_student_view</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> name,age,score <span class="keyword">from</span> class</span><br><span class="line"><span class="keyword">where</span> score<span class="operator">&gt;=</span><span class="number">80</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 如果视图是通过外连接创建的，尽量不要进行写操作，如果是简单多表查询形成的视图写操作也不能同时修改多个基础表数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> student_hobby_view</span><br><span class="line"><span class="keyword">as</span> <span class="keyword">select</span> class.name,score,hobby,price</span><br><span class="line"><span class="keyword">from</span> class <span class="keyword">left</span> <span class="keyword">join</span> hobby</span><br><span class="line"><span class="keyword">on</span> class.name<span class="operator">=</span>hobby.name;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>视图表的增删改查操作</p>
<p>视图的增删改查操作与一般表的操作相同，使用insert update delete select即可，但是原数据表的约束条件仍然对视图产生作用。</p>
</li>
<li><p>查看现有视图</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">full</span> tables <span class="keyword">in</span> stu</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改视图</p>
<p>参考创建视图，将create关键字改为alter </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter view good_student_view</span><br><span class="line">as select name,age,sex,score from class</span><br><span class="line">where score&gt;=85;</span><br></pre></td></tr></table></figure>


</li>
<li><p>删除视图</p>
<p>drop view [IF EXISTS] 视图名；</p>
<p>IF EXISTS 表示如果存在，这样即使没有指定视图也不会报错。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">view</span> if <span class="keyword">exists</span> hobby_stu;</span><br></pre></td></tr></table></figure>


</li>
<li><p>视图作用</p>
<ul>
<li>作用</li>
</ul>
<ol>
<li><p>是对数据的一种重构，不影响原数据表的使用。</p>
</li>
<li><p>简化高频复杂操作的过程，就像一种对复杂操作的封装。</p>
</li>
<li><p>提高安全性，可以给不同用户提供不同的视图。</p>
</li>
<li><p>让数据更加清晰。</p>
</li>
</ol>
<ul>
<li>缺点</li>
</ul>
<ol>
<li>视图的性能相对较差，从数据库视图查询数据可能会很慢。</li>
</ol>
</li>
</ul>
<h2 id="8-函数和存储过程"><a href="#8-函数和存储过程" class="headerlink" title="8. 函数和存储过程"></a>8. 函数和存储过程</h2><p>存储过程和函数是事先经过编译并存储在数据库中的一段sql语句集合，调用存储过程和函数可以简化应用开发工作，提高数据处理的效率。</p>
<h3 id="8-1-函数创建"><a href="#8-1-函数创建" class="headerlink" title="8.1 函数创建"></a>8.1 函数创建</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">delimiter 自定义符号　　</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> 函数名(形参列表) <span class="keyword">returns</span> 返回类型　　<span class="comment">-- 注意是retruns</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">　　函数体   <span class="comment">-- 若干sql语句，但是不要直接写查询</span></span><br><span class="line">　　<span class="keyword">return</span> val;</span><br><span class="line"><span class="keyword">end</span>  自定义符号</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">释义：</span><br><span class="line">delimiter 自定义符号 是为了在函数内些语句方便，制定除了;之外的符号作为函数书写结束标志,一般用$$或者<span class="operator">/</span><span class="operator">/</span></span><br><span class="line">形参列表 ： 形参名 类型   类型为mysql支持类型</span><br><span class="line">返回类型:  函数返回的数据类型,mysql支持类型即可</span><br><span class="line">函数体： 若干<span class="keyword">sql</span>语句组成</span><br><span class="line"><span class="keyword">return</span>: 返回指定类型返回值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">e.g. </span><br><span class="line"><span class="comment">-- 如果函数中有写操作则函数不能放在where语句中使用</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> st() <span class="keyword">returns</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> class <span class="keyword">set</span> sex<span class="operator">=</span><span class="string">&#x27;m&#x27;</span> <span class="keyword">where</span> name<span class="operator">=</span>&quot;tonny&quot;;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">select</span> score <span class="keyword">from</span> class <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;Tonny&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> st1() <span class="keyword">returns</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">select</span> score <span class="keyword">from</span> class <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;Tonny&#x27;</span>);</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line"></span><br><span class="line"><span class="comment">--局部变量 ： 获得最高分和最低分分数差</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> st2() <span class="keyword">returns</span> <span class="type">int</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> num_1 <span class="type">int</span>;</span><br><span class="line">    <span class="keyword">declare</span> num_2 <span class="type">int</span>;</span><br><span class="line">    <span class="keyword">set</span> num_1<span class="operator">=</span>(<span class="keyword">select</span> score <span class="keyword">from</span> class <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span> limit <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">select</span> score <span class="keyword">from</span> class <span class="keyword">order</span> <span class="keyword">by</span> score limit <span class="number">1</span> <span class="keyword">into</span> num_2;</span><br><span class="line">    <span class="keyword">return</span> num_1<span class="operator">-</span>num_2;</span><br><span class="line"><span class="keyword">end</span> $$</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e.g. 含有参数的函数调用</span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> queryNameById(uid <span class="type">int</span>) <span class="keyword">returns</span> <span class="type">varchar</span>(<span class="number">20</span>)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"><span class="keyword">return</span>  (<span class="keyword">select</span> name <span class="keyword">from</span> class <span class="keyword">where</span> id<span class="operator">=</span>uid);</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> queryNameById(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<ul>
<li>设置变量<ul>
<li>定义用户变量 ： set  @[变量名] &#x3D; 值；使用时用@[变量名]。</li>
<li>定义局部变量 ： 在函数内部设置  declare   [变量名]    [变量类型]; 局部变量可以使用set赋值或者使用into关键字。</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">函数练习：</span><br><span class="line">books表完成 ，编写一个函数，传入两本书的名字，得到两本书的价格之差</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> get_price(book1 <span class="type">varchar</span>(<span class="number">30</span>),book2 <span class="type">varchar</span>(<span class="number">30</span>))</span><br><span class="line"><span class="keyword">returns</span> <span class="type">float</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">declare</span> price1 <span class="type">float</span>;</span><br><span class="line">    <span class="keyword">declare</span> price2 <span class="type">float</span>;</span><br><span class="line">    <span class="keyword">select</span> price <span class="keyword">from</span> books <span class="keyword">where</span> bname<span class="operator">=</span>book1 <span class="keyword">into</span> price1;</span><br><span class="line">    <span class="keyword">select</span> price <span class="keyword">from</span> books <span class="keyword">where</span> bname<span class="operator">=</span>book2 <span class="keyword">into</span> price2;</span><br><span class="line">    <span class="keyword">return</span> price1<span class="operator">-</span>price2;</span><br><span class="line"><span class="keyword">end</span> $$</span><br></pre></td></tr></table></figure>



<h3 id="8-2存储过程创建"><a href="#8-2存储过程创建" class="headerlink" title="8.2存储过程创建"></a>8.2存储过程创建</h3><p>创建存储过程语法与创建函数基本相同，但是没有返回值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">delimiter 自定义符号　</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> 存储过程名(形参列表)</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">　	存储过程　　　　<span class="comment">-- sql语句构成存储过程语句集</span></span><br><span class="line"><span class="keyword">end</span>  自定义符号</span><br><span class="line"></span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line">释义：</span><br><span class="line">delimiter 自定义符号 是为了在函数内些语句方便，制定除了;之外的符号作为函数书写结束标志</span><br><span class="line">形参列表 ：[ <span class="keyword">IN</span> <span class="operator">|</span> <span class="keyword">OUT</span> <span class="operator">|</span> <span class="keyword">INOUT</span> ] 形参名 类型</span><br><span class="line">          <span class="keyword">in</span> 输入，<span class="keyword">out</span>  输出，<span class="keyword">inout</span> 可以输入也可以输出</span><br><span class="line">存储过程： 若干<span class="keyword">sql</span>语句组成，如果只有一条语句也可以不写delimiter和<span class="keyword">begin</span>,<span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">e.g. 存储过程创建和调用</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> st()</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">from</span> class <span class="keyword">where</span> name<span class="operator">=</span>&quot;James&quot;;</span><br><span class="line">    <span class="keyword">update</span> class <span class="keyword">set</span> score<span class="operator">=</span><span class="number">71</span> <span class="keyword">where</span> name<span class="operator">=</span>&quot;Emma&quot;;</span><br><span class="line">    <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">call</span> st();</span><br></pre></td></tr></table></figure>

<ul>
<li><p>存储过程三个参数的区别</p>
<ul>
<li><p>IN 类型参数可以接收变量也可以接收常量，传入的参数在存储过程内部使用即可，但是在存储过程内部的修改无法传递到外部。</p>
</li>
<li><p>OUT 类型参数只能接收一个变量，接收的变量不能够在存储过程内部使用（内部为NULL），但是可以在存储过程内对这个变量进行修改。因为定义的变量是全局的，所以外部可以获取这个修改后的值。</p>
</li>
<li><p>INOUT类型参数同样只能接收一个变量，但是这个变量可以在存储过程内部使用。在存储过程内部的修改也会传递到外部。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">e.g. : 分别将参数类型改为<span class="keyword">IN</span> <span class="keyword">OUT</span> <span class="keyword">INOUT</span> 看一下结果区别</span><br><span class="line">delimiter $$</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> p_out ( <span class="keyword">OUT</span> num <span class="type">int</span> )</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">select</span> num;</span><br><span class="line">    <span class="keyword">set</span> num<span class="operator">=</span><span class="number">100</span>;</span><br><span class="line">    <span class="keyword">select</span> num;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@num</span><span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"><span class="keyword">call</span> p_out(<span class="variable">@num</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">存储过程练习：</span><br><span class="line">books表，使用存储过程完成，将<span class="number">2020</span>年以前出版的图书价格增加<span class="number">3</span>元，参数传入一个作家的名字，将该作家的图书，在此基础上再涨<span class="number">2</span>元，按照图书价格打印出图书信息，只要书名，作者和价格即可</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> get_books(<span class="keyword">in</span> aname <span class="type">varchar</span>(<span class="number">30</span>))</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> books <span class="keyword">set</span> price<span class="operator">=</span>price<span class="operator">+</span><span class="number">3</span> <span class="keyword">where</span> p_time<span class="operator">&lt;</span>&quot;2020-01-01&quot;;</span><br><span class="line">    <span class="keyword">update</span> books <span class="keyword">set</span> price<span class="operator">=</span>price<span class="operator">+</span><span class="number">2</span> <span class="keyword">where</span> author<span class="operator">=</span>aname;</span><br><span class="line">    <span class="keyword">select</span> bname,author,price <span class="keyword">from</span> books <span class="keyword">order</span> <span class="keyword">by</span> price;</span><br><span class="line"><span class="keyword">end</span> $$</span><br></pre></td></tr></table></figure>



<h3 id="8-3-存储过程和存储函数操作"><a href="#8-3-存储过程和存储函数操作" class="headerlink" title="8.3 存储过程和存储函数操作"></a>8.3 存储过程和存储函数操作</h3><ol>
<li>调用存储过程</li>
</ol>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call 存储过程名字（[存储过程的参数[,……]])</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>调用存储函数</li>
</ol>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 存储函数名字（[函数的参数[,……]])</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>使用show create语句查看存储过程和函数的定义</li>
</ol>
<p>语法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show create  &#123;procedure|function&#125;  存储过程或存储函数的名称</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>查看所有函数或者存储过程</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select name,type from mysql.proc where db=&#x27;stu&#x27;;</span><br><span class="line">show procedure|function status  where db=&quot;stu&quot;;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>删除存储过程或存储函数</li>
</ol>
<p>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> &#123;<span class="keyword">PROCEDURE</span> <span class="operator">|</span> <span class="keyword">FUNCTION</span>&#125; [IF <span class="keyword">EXISTS</span>] sp_name</span><br></pre></td></tr></table></figure>



<h3 id="8-4-函数和存储过程区别"><a href="#8-4-函数和存储过程区别" class="headerlink" title="8.4 函数和存储过程区别"></a>8.4 函数和存储过程区别</h3><ol>
<li>函数有且只有一个返回值，而存储过程不能有返回值。</li>
<li>函数只能有普通参数，而存储过程可以有in,out,inout多个类型参数。</li>
<li>存储过程中的语句功能更丰富，实现更复杂的业务逻辑，可以理解为一个按照预定步骤调用的执行过程，而函数中不能展示查询结果集语句，只是完成查询的工作后返回一个结果，功能针对性比较强。</li>
<li>存储过程一般是作为一个独立的部分来执行(call调用)。而函数可以作为查询语句的一个部分来调用。</li>
</ol>
<h2 id="9-事务控制"><a href="#9-事务控制" class="headerlink" title="9. 事务控制"></a>9. 事务控制</h2><h3 id="9-1-事务概述"><a href="#9-1-事务概述" class="headerlink" title="9.1 事务概述"></a>9.1 事务概述</h3><p>MySQL 事务主要用于处理操作量大，复杂度高的数据。比如说，在人员管理系统中，你删除一个人员，既需要删除人员的基本资料，也要删除和该人员相关的信息，如信箱，文章等等，如果操作就必须同时操作成功，如果有一个不成功则所有数据都不动。这时候数据库操作语句就构成一个事务。事务主要处理数据的增删改操作。</p>
<ul>
<li>定义</li>
</ul>
<blockquote>
<p>一件事从开始发生到结束的过程</p>
</blockquote>
<ul>
<li>作用</li>
</ul>
<blockquote>
<p>确保数据操作过程中的数据完整和使用安全。</p>
</blockquote>
<h3 id="9-2-事务操作"><a href="#9-2-事务操作" class="headerlink" title="9.2 事务操作"></a>9.2 事务操作</h3><ol>
<li>开启事务</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;begin; </span><br></pre></td></tr></table></figure>

<ol start="2">
<li>开始执行事务中的若干条SQL命令（增删改）</li>
<li>终止事务，若begin之后使用commit提交事务或者使用rollback进行事务回滚。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;commit; # 事务中SQL命令都执行成功,提交到数据库,结束!</span><br><span class="line">mysql&gt;rollback; # 有SQL命令执行失败,回滚到初始状态,结束!</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：事务操作只针对数据操作。rollback不能对数据库，数据表结构操作恢复。</p>
</blockquote>
<h3 id="9-3-事务四大特性"><a href="#9-3-事务四大特性" class="headerlink" title="9.3 事务四大特性"></a>9.3 事务四大特性</h3><ol>
<li>原子性（atomicity）</li>
</ol>
<blockquote>
<p>一个事务必须视为一个不可分割的最小工作单元，对于一个事务来说，不可能只执行其中的一部分操作,整个事务中的所有操作要么全部提交成功，要么全部失败回滚</p>
</blockquote>
<ol start="2">
<li>一致性（consistency）</li>
</ol>
<blockquote>
<p>事务完成时，数据必须处于一致状态，数据的完整性约束没有被破坏。</p>
</blockquote>
<ol start="3">
<li>隔离性（isolation）</li>
</ol>
<blockquote>
<p>数据库允许多个并发事务同时对其数据进行读写和修改的能力，而多个事务相互独立。隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。</p>
</blockquote>
<ol start="4">
<li>持久性（durability）</li>
</ol>
<blockquote>
<p>一旦事务提交，则其所做的修改就会永久保存到数据库中。此时即使系统崩溃，修改的数据也不会丢失。</p>
</blockquote>
<h3 id="9-4-事务隔离级别"><a href="#9-4-事务隔离级别" class="headerlink" title="9.4 事务隔离级别"></a>9.4 事务隔离级别</h3><p>事务四大特性中的隔离性是在使用事务时最为需要注意的特性，因为隔离级别不同带来的操作现象也有区别</p>
<ul>
<li><p>隔离级别</p>
<ul>
<li><p>读未提交：read uncommitted</p>
<blockquote>
<p>事物A和事物B，事物A未提交的数据，事物B可以读取到<br>这里读取到的数据叫做“脏数据”<br>这种隔离级别最低，这种级别一般是在理论上存在，数据库隔离级别一般都高于该级别</p>
</blockquote>
</li>
<li><p>读已提交：read committed</p>
<blockquote>
<p>事物A和事物B，事物A提交的数据，事物B才能读取到<br>这种隔离级别高于读未提交<br>换句话说，对方事物提交之后的数据，我当前事物才能读取到<br>这种级别可以避免“脏数据”<br>这种隔离级别会导致“不可重复读取”</p>
</blockquote>
</li>
<li><p>可重复读：repeatable read</p>
<blockquote>
<p>事务A和事务B，事务A提交之后的数据，事务B读取不到<br>事务B是可重复读取数据<br>这种隔离级别高于读已提交<br>MySQL默认级别<br>虽然可以达到可重复读取，但是会导致“幻像读”</p>
</blockquote>
</li>
<li><p>串行化：serializable</p>
<blockquote>
<p>事务A和事务B，事务A在操作数据库时，事务B只能排队等待<br>这种隔离级别很少使用，吞吐量太低，用户体验差<br>这种级别可以避免“幻像读”，每一次读取的都是数据库中真实存在数据，事务A与事务B串行，而不并发</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="10-数据库优化"><a href="#10-数据库优化" class="headerlink" title="10.数据库优化"></a>10.数据库优化</h2><h3 id="10-1-数据库设计范式"><a href="#10-1-数据库设计范式" class="headerlink" title="10.1 数据库设计范式"></a>10.1 数据库设计范式</h3><p>设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式。</p>
<blockquote>
<p>目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式(4NF）和第五范式（5NF，又称完美范式）。</p>
</blockquote>
<p>各种范式呈递次规范，越高的范式数据库冗余越小。但是范式越高也意味着表的划分更细，一个数据库中需要的表也就越多，此时多个表联接在一起的花费是巨大的，尤其是当需要连接的两张或者多张表数据非常庞大的时候，表连接操作几乎是一个噩梦，这严重地降低了系统运行性能。所以通常数据库设计遵循第一第二第三范式，以避免数据操作异常,又不至于表关系过于复杂。</p>
<p>范式简介：</p>
<ul>
<li><p>第一范式： 数据库表的每一列都是不可分割的原子数据项，而不能是集合，数组，记录等组合的数据项。简单来说要求数据库中的表示二维表，每个数据元素不可再分。</p>
<p>例如： 在国内的话通常理解都是姓名是一个不可再拆分的单位，这时候就符合第一范式；但是在国外的话还要分为FIRST NAME和LAST NAME，这时候姓名这个字段就是还可以拆分为更小的单位的字段，就不符合第一范式了。</p>
</li>
<li><p>第二范式： 第二范式（2NF）要求数据库表中的每个实例或记录必须可以被唯一地区分，所有属性依赖于主属性。即选取一个能区分每个实体的属性或属性组，作为实体的唯一标识，每个属性都能被主属性筛选。其实简单理解要设置一个区分各个记录的主键就好了。</p>
</li>
<li><p>第三范式： 在第二范式的基础上属性不传递依赖，即每个属性不依赖其他非主属性。要求一个表中不包含已在其它表中包含的非主关键字信息。其实简单来说就是合理使用外键，使不同的表中不要有重复的字段就好了。</p>
</li>
</ul>
<h3 id="10-2-MySQL存储引擎"><a href="#10-2-MySQL存储引擎" class="headerlink" title="10.2  MySQL存储引擎"></a>10.2  MySQL存储引擎</h3><ul>
<li><strong>定义</strong>： mysql数据库管理系统中用来处理表的处理器</li>
<li><strong>基本操作</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、查看所有存储引擎</span><br><span class="line">   mysql&gt; show engines;</span><br><span class="line">2、查看已有表的存储引擎</span><br><span class="line">   mysql&gt; show create table 表名;</span><br><span class="line">3、创建表指定</span><br><span class="line">   create table 表名(...)engine=MyISAM;</span><br><span class="line">4、已有表指定</span><br><span class="line">   alter table 表名 engine=InnoDB;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>常用存储引擎特点</strong> </p>
<p><strong>InnoDB</strong>		</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 支持行级锁,仅对指定的记录进行加锁，这样其它进程还是可以对同一个表中的其它记录进		行操作。</span><br><span class="line">2. 支持外键、事务、事务回滚</span><br><span class="line">3. 表字段和索引同存储在一个文件中</span><br><span class="line">		 1. 表名.frm ：表结构</span><br><span class="line"> 		 2. 表名.ibd : 表记录及索引文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>MyISAM</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 支持表级锁,在锁定期间，其它进程无法对该表进行写操作。如果你是写锁，则其它进程则		读也不允许</span><br><span class="line"><span class="number">2.</span>  表字段和索引分开存储</span><br><span class="line">      	 <span class="number">1.</span> 表名.frm ：表结构</span><br><span class="line">         <span class="number">2.</span> 表名.MYI : 索引文件(my index)</span><br><span class="line">         <span class="number">3.</span> 表名.MYD : 表记录(my data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>如何选择存储引擎</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1. 执行查操作多的表用 MyISAM(使用InnoDB浪费资源)</span><br><span class="line">2. 执行写操作多的表用 InnoDB</span><br><span class="line"></span><br><span class="line">CREATE TABLE user(</span><br><span class="line">id int(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">name varchar(30) DEFAULT NULL,</span><br><span class="line">sex varchar(2) DEFAULT NULL,</span><br><span class="line">PRIMARY KEY (id)</span><br><span class="line">)ENGINE=MyISAM;</span><br><span class="line"></span><br><span class="line">alter table hobby engine=myisam;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="10-3-字段数据类型和键的选择"><a href="#10-3-字段数据类型和键的选择" class="headerlink" title="10.3 字段数据类型和键的选择"></a>10.3 字段数据类型和键的选择</h3><ul>
<li>数据类型优先程度   数字类型 –&gt;  时间日期类型  –&gt; 字符串类型</li>
<li>同一级别   占用空间小的 –&gt; 占用空间大的</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">字符串在查询比较排序时数据处理慢</span><br><span class="line">占用空间少，数据库占磁盘页少，读写处理就更快</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Innodb如果不设置主键也会自己设置隐含的主键，所以最好自己设置</li>
<li>尽量设置占用空间小的字段为主键</li>
<li>建立外键会自动建立索引，在表关联查询时建议使用外键子段作为关联条件</li>
<li>外键虽然可以保持数据完整性，但是会降低数据导入和操作效率，增加维护成本</li>
</ul>
<h3 id="10-4-SQL优化"><a href="#10-4-SQL优化" class="headerlink" title="10.4 SQL优化"></a>10.4 SQL优化</h3><ul>
<li>explain工具</li>
</ul>
<p>使用 EXPLAIN 关键字可以模拟优化器执行SQL查询语句，从而知道MySQL是如何处理你的SQL语句的。这可以帮你分析你的查询语句或是表结构的性能瓶颈。通过explain命令可以得到:</p>
<ul>
<li>表的读取顺序</li>
<li>数据读取操作的操作类型</li>
<li>哪些索引可以使用</li>
<li>哪些索引被实际使用</li>
<li>表之间的引用</li>
<li>每张表有多少行被优化器查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> class <span class="keyword">where</span> id <span class="operator">&lt;</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure>



<p>EXPLAIN主要字段解析：</p>
<ul>
<li>table：显示这一行的数据是关于哪张表的</li>
<li>type：这是最重要的字段之一，显示查询使用了何种类型。从最好到最差的连接类型为system、const、eq_reg、ref、range、index和ALL，一般来说，得保证查询至少达到range级别，最好能达到ref。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">type中包含的值：</span><br><span class="line">- system、const： 可以将查询的变量转为常量. 如id=1; id为 主键或唯一键.</span><br><span class="line">- eq_ref： 访问索引,返回某单一行的数据.(通常在联接时出现，查询使用的索引为主键或唯一键)</span><br><span class="line">- ref： 访问索引,返回某个值的数据.(可以返回多行) 通常使用=时发生 </span><br><span class="line">- range： 这个连接类型使用索引返回一个范围中的行，比如使用&gt;或&lt;查找东西，并且该字段上建有索引时发生的情况</span><br><span class="line">- index： 以索引的顺序进行全表扫描，优点是不用排序,缺点是还要全表扫描 </span><br><span class="line">- ALL： 全表扫描，应该尽量避免</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>possible_keys：显示可能应用在这张表中的索引。如果为空，表示没有可能应用的索引。</li>
<li>key：实际使用的索引。如果为NULL，则没有使用索引。</li>
<li>key_len：使用的索引的长度。在不损失精确性的情况下，长度越短越好</li>
<li>rows：MySQL认为必须检索的用来返回请求数据的行数</li>
</ul>
<p>SQL语句优化方法</p>
<ul>
<li><p>尽量选择数据类型占空间少，在where ，group by，order by中出现的频率高的字段建立索引</p>
</li>
<li><p>尽量避免使用 select * …;用具体字段代替 * ,不要返回用不到的任何字段 </p>
</li>
<li><p>尽量控制使用自定义函数</p>
</li>
<li><p>查询最后添加 LIMIT 会停止全表扫描</p>
</li>
<li><p>尽量避免 NULL 值判断,否则会进行全表扫描，默认值为空时可以用默认0代替</p>
<p>优化前：select number from t1 where number is null;</p>
<p>优化后：select number from t1 where number&#x3D;0;</p>
</li>
<li><p>尽量避免 or 连接条件,否则会放弃索引进行全表扫描，可以用union代替</p>
<p>优化前：select id from t1 where id&#x3D;10 or id&#x3D;20;</p>
<p>优化后： select id from t1 where id&#x3D;10 union all  select id from t1 where id&#x3D;20;</p>
</li>
<li><p>尽量避免使用 in 和 not in,否则会全表扫描</p>
<p>优化前：select id from t1 where id in (1,2,3,4);</p>
<p>优化后：select id from t1 where id between 1 and 4;</p>
</li>
</ul>
<h3 id="10-5-表的拆分"><a href="#10-5-表的拆分" class="headerlink" title="10.5 表的拆分"></a>10.5 表的拆分</h3><p>垂直拆分 ： 表中列太多，分为多个表，每个表是其中的几个列。将常查询的放到一起，blob或者text类型字段放到另一个表</p>
<p>水平拆分 ： 减少每个表的数据量，通过关键字进行划分然后拆成多个表</p>
<h2 id="11-数据备份和导入"><a href="#11-数据备份和导入" class="headerlink" title="11. 数据备份和导入"></a>11. 数据备份和导入</h2><h3 id="11-1-表的复制"><a href="#11-1-表的复制" class="headerlink" title="11.1 表的复制"></a>11.1 表的复制</h3><ol>
<li>表能根据实际需求复制数据</li>
<li>复制表时不会把KEY属性复制过来</li>
</ol>
<p><strong>语法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table 表名 select 查询命令;</span><br><span class="line"></span><br><span class="line">create table student select name,age,score from class where score&gt;80</span><br></pre></td></tr></table></figure>



<h3 id="11-2-数据库备份"><a href="#11-2-数据库备份" class="headerlink" title="11.2 数据库备份"></a>11.2 数据库备份</h3><ol>
<li>备份命令格式</li>
</ol>
<blockquote>
<p>mysqldump   -u  用户名   -p   源库名  &gt;  stu.sql</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p stu &gt; stu.sql</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>恢复命令格式</li>
</ol>
<blockquote>
<p>mysql   -u  root   -p    目标库名 &lt;  stu.sql</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p student &lt; stu.sql</span><br></pre></td></tr></table></figure>



<h2 id="12-数据库管理"><a href="#12-数据库管理" class="headerlink" title="12. 数据库管理"></a>12. 数据库管理</h2><h3 id="12-1-MySQL远程连接"><a href="#12-1-MySQL远程连接" class="headerlink" title="12.1 MySQL远程连接"></a>12.1 MySQL远程连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">更改配置文件，重启服务！</span><br><span class="line">1.cd /etc/mysql/mysql.conf.d</span><br><span class="line">2.sudo vi mysqld.cnf  找到43行左右,加 # 注释</span><br><span class="line">   # bind-address = 127.0.0.1</span><br><span class="line">   </span><br><span class="line">3.保存退出</span><br><span class="line">4.sudo service mysql restart</span><br><span class="line">5.进入mysql修改用户表host值 </span><br><span class="line">  use mysql;</span><br><span class="line">  update user set host=&#x27;%&#x27; where user=&#x27;root&#x27;;</span><br><span class="line">6.刷新权限</span><br><span class="line">  flush privileges;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="12-2-添加用户和授权"><a href="#12-2-添加用户和授权" class="headerlink" title="12.2 添加用户和授权"></a>12.2 添加用户和授权</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1. 用root用户登录mysql</span><br><span class="line">   mysql -u root -p</span><br><span class="line">   </span><br><span class="line">2. 添加用户 % 表示自动选择可用IP</span><br><span class="line">   CREATE USER &#x27;username&#x27;@&#x27;host&#x27; IDENTIFIED BY &#x27;password&#x27;;</span><br><span class="line">   </span><br><span class="line">3. 权限管理</span><br><span class="line"></span><br><span class="line">   # 增加权限</span><br><span class="line">   grant 权限列表 on 库.表 to &quot;用户名&quot;@&quot;%&quot; identified by &quot;密码&quot; with grant option;</span><br><span class="line">   </span><br><span class="line">   # 删除权限</span><br><span class="line">   revoke insert,update,select on 库.表 from &#x27;user&#x27;@&#x27;%&#x27;;</span><br><span class="line">   </span><br><span class="line">4. 刷新权限</span><br><span class="line">   flush privileges;</span><br><span class="line">   </span><br><span class="line">5. 删除用户</span><br><span class="line">   drop user &quot;用户名&quot;@&quot;%&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>权限列表</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">all privileges ，select ，insert ，update，delete，alter，create，drop等。</span><br><span class="line">库.表 ： *.* 代表所有库的所有表</span><br><span class="line"></span><br><span class="line">权限添加和删除时指定库表的方式需要一样</span><br></pre></td></tr></table></figure>

<p><strong>示例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1. 创建用户</span><br><span class="line">  mysql&gt;create user  &#x27;work&#x27;@&#x27;%&#x27;  identified by &#x27;123&#x27;;</span><br><span class="line">  </span><br><span class="line">2. 添加授权用户work,密码123,对所有库的所有表有所有权限</span><br><span class="line">  mysql&gt;grant all privileges on *.* to &#x27;work&#x27;@&#x27;%&#x27; identified by &#x27;123&#x27; with grant option;</span><br><span class="line">  mysql&gt;flush privileges;</span><br><span class="line">  </span><br><span class="line">3. 添加用户duty，密码123,对books库中所有表有查看，插入权限</span><br><span class="line">  mysql&gt;grant select,insert on books.* to &#x27;duty&#x27;@&#x27;%&#x27; identified by &#x27;123&#x27; with grant option;</span><br><span class="line">  mysql&gt;flush privileges;</span><br><span class="line">  </span><br><span class="line">4. 删除work用户的删除权限</span><br><span class="line">  mysql&gt;revoke delete on *.* from &quot;work&quot;@&quot;%&quot;;</span><br><span class="line">  </span><br><span class="line">5. 删除用户duty</span><br><span class="line">  drop user &quot;duty&quot;@&quot;%&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="13-pymysql模块"><a href="#13-pymysql模块" class="headerlink" title="13. pymysql模块"></a>13. pymysql模块</h2><p>pymysql是一个第三方库，如果自己的计算机上没有可以在终端使用命令进行安装。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pip3 install pymysql</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>pymysql使用流程</li>
</ul>
<ol>
<li>建立数据库连接：db &#x3D; pymysql.connect(…)</li>
<li>创建游标对象：cur &#x3D; db.cursor()</li>
<li>游标方法:  cur.execute(“insert ….”)</li>
<li>提交到数据库或者获取数据 :  db.commit() &#x2F; cur.fetchall()</li>
<li>关闭游标对象 ：cur.close()</li>
<li>断开数据库连接 ：db.close()</li>
</ol>
<ul>
<li>常用函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">db = pymysql.connect(参数列表)</span><br><span class="line">功能: 链接数据库</span><br><span class="line"></span><br><span class="line">host ：主机地址,本地 localhost</span><br><span class="line">port ：端口号,默认<span class="number">3306</span></span><br><span class="line">user ：用户名</span><br><span class="line">password ：密码</span><br><span class="line">database ：库</span><br><span class="line">charset ：编码方式,推荐使用 utf8</span><br><span class="line"></span><br><span class="line">cur = db.cursor() </span><br><span class="line">功能： 创建游标</span><br><span class="line">返回值：返回游标对象,用于执行具体SQL命令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cur.execute(sql,args_list) </span><br><span class="line">功能： 执行SQL命令</span><br><span class="line">参数： sql sql语句</span><br><span class="line">      args_list  列表，用于给sql语句传递参量</span><br><span class="line">      </span><br><span class="line">cur.executemany(sql命令,args_list)</span><br><span class="line">功能： 多次执行SQL命令，执行次数由列表中元组数量决定</span><br><span class="line">参数： sql sql语句</span><br><span class="line">      args_list  列表中包含元组 每个元组用于给sql语句传递参量，一般用于写操作。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db.commit() 提交到数据库执行，必须支持事务操作才有效</span><br><span class="line">db.rollback() 回到原来的数据形态，必须支持事务操作才有效</span><br><span class="line">cur.fetchone() 获取查询结果集的第一条数据，查找到返回一个元组否则返回<span class="literal">None</span></span><br><span class="line">cur.fetchmany(n) 获取前n条查找到的记录，返回结果为元组嵌套元组， ((记录<span class="number">1</span>),(记录<span class="number">2</span>))，查询不到内容返回空元组。</span><br><span class="line">cur.fetchall() 获取所有查找到的记录，返回结果形式同上。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cur.close() 关闭游标对象</span><br><span class="line">db.close() 关闭数据库连接</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">连接关闭数据库示例：</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">数据库操作基本结构示例</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">kwargs = &#123;</span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;stu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 链接数据库</span></span><br><span class="line">db = pymysql.connect(**kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成游标  游标：调用sql操作数据得到操作结果的对象</span></span><br><span class="line">cur = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 操作数据 读 / 写</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">cur.close()</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">数据库读操作示例：</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">数据库读操作示例</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">kwargs = &#123;</span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;stu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 链接数据库</span></span><br><span class="line">db = pymysql.connect(**kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成游标  游标：调用sql操作数据得到操作结果的对象</span></span><br><span class="line">cur = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 操作数据 读</span></span><br><span class="line"><span class="comment"># sql = &quot;select name,age,score from class where score&gt;80;&quot;</span></span><br><span class="line"><span class="comment"># cur.execute(sql) # 执行语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给sql语句传值 使用第二个参数按照位置给sql语句%s传值</span></span><br><span class="line">sql = <span class="string">&quot;select name,age,score from class &quot;</span> \</span><br><span class="line">      <span class="string">&quot;where score&gt;%s and sex=%s;&quot;</span></span><br><span class="line">cur.execute(sql,[<span class="number">80</span>,<span class="string">&#x27;m&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个查询结果</span></span><br><span class="line">one = cur.fetchone()</span><br><span class="line"><span class="built_in">print</span>(one)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个查询结果</span></span><br><span class="line">many = cur.fetchmany(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(many)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有查询结果</span></span><br><span class="line"><span class="built_in">all</span> = cur.fetchall()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">all</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代获取结果</span></span><br><span class="line"><span class="comment"># for row in cur:</span></span><br><span class="line"><span class="comment">#     print(row)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">cur.close()</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">文件写操作示例：</span><br><span class="line"></span><br><span class="line">数据库写操作示例</span><br><span class="line">pymysql进行写操作如果数据表支持事务会自动开启事务</span><br><span class="line">需要commit提交才能生效</span><br><span class="line">如果数据表不支持事务则直接execute执行则生效</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">kwargs = &#123;</span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;stu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 链接数据库</span></span><br><span class="line">db = pymysql.connect(**kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成游标  游标：调用sql操作数据得到操作结果的对象</span></span><br><span class="line">cur = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 操作数据  写  insert delete update</span></span><br><span class="line"><span class="comment"># try:</span></span><br><span class="line"><span class="comment">#     sql = &quot;update class set score=%s where name=%s;&quot;</span></span><br><span class="line"><span class="comment">#     cur.execute(sql,[99,&quot;Tom&quot;])</span></span><br><span class="line"><span class="comment">#     db.commit() # 提交事务</span></span><br><span class="line"><span class="comment"># except Exception as e:</span></span><br><span class="line"><span class="comment">#     print(e)</span></span><br><span class="line"><span class="comment">#     db.rollback()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量写操作</span></span><br><span class="line">data = [</span><br><span class="line">    (<span class="string">&quot;zhang&quot;</span>,<span class="string">&#x27;19&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="number">70</span>),</span><br><span class="line">    (<span class="string">&quot;wang&quot;</span>,<span class="string">&#x27;18&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="number">71</span>),</span><br><span class="line">    (<span class="string">&quot;li&quot;</span>,<span class="string">&#x27;20&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="number">72</span>)</span><br><span class="line">]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    sql = <span class="string">&quot;insert into class &quot;</span> \</span><br><span class="line">          <span class="string">&quot;(name,age,sex,score) &quot;</span> \</span><br><span class="line">          <span class="string">&quot;values (%s,%s,%s,%s);&quot;</span></span><br><span class="line">    cur.executemany(sql,data) <span class="comment"># 多次执行语句</span></span><br><span class="line">    db.commit() <span class="comment"># 提交事务</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(e)</span><br><span class="line">    db.rollback()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">cur.close()</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">写操作练习：</span><br><span class="line">创建数据库 <span class="built_in">dict</span>，数据库中创建数据表 words 字段为 ： <span class="built_in">id</span>  word  mean</span><br><span class="line">编写一个程序，将<span class="built_in">dict</span>.txt单词本中的单词存储到这个数据表里</span><br><span class="line"></span><br><span class="line">库 ： <span class="built_in">dict</span></span><br><span class="line">create database <span class="built_in">dict</span> charset=utf8;</span><br><span class="line"></span><br><span class="line">表 ： words --&gt;  <span class="built_in">id</span>  word  mean</span><br><span class="line">create table words (</span><br><span class="line"><span class="built_in">id</span> <span class="built_in">int</span> primary key auto_increment,</span><br><span class="line">word char(<span class="number">30</span>),</span><br><span class="line">mean varchar(<span class="number">512</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dict</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.kwargs = &#123;</span><br><span class="line">            <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">            <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">            <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">            <span class="string">&quot;database&quot;</span>: <span class="string">&quot;dict&quot;</span>,</span><br><span class="line">            <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">self</span>.connect()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 完成数据库连接</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.db = pymysql.connect(**<span class="variable language_">self</span>.kwargs)</span><br><span class="line">        <span class="variable language_">self</span>.cur = <span class="variable language_">self</span>.db.cursor()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">close</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.cur.close()</span><br><span class="line">        <span class="variable language_">self</span>.db.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 插入数据  提取文件中的单词</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_words</span>(<span class="params">self, filename</span>):</span><br><span class="line">        file = <span class="built_in">open</span>(filename)</span><br><span class="line">        words = []  <span class="comment"># [(word,mean),(word,mean)...]</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">            tmp = re.findall(<span class="string">r&quot;(\w+)\s+(.*)&quot;</span>, line)</span><br><span class="line">            words += tmp  <span class="comment"># 大列表</span></span><br><span class="line">        file.close()</span><br><span class="line">        <span class="variable language_">self</span>.insert_data(words)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_data</span>(<span class="params">self, words</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            sql = <span class="string">&quot;insert into words (word,mean) values (%s,%s);&quot;</span></span><br><span class="line">            <span class="variable language_">self</span>.cur.executemany(sql, words)</span><br><span class="line">            <span class="variable language_">self</span>.db.commit()  <span class="comment"># 提交事务</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            <span class="variable language_">self</span>.db.rollback()  <span class="comment"># 事务回滚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">dict</span> = <span class="type">Dict</span>()</span><br><span class="line">    <span class="built_in">dict</span>.insert_words(<span class="string">&quot;dict.txt&quot;</span>)  <span class="comment"># 插入单词数据</span></span><br><span class="line">    <span class="built_in">dict</span>.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">数据库读操作练习：在stu下创建一个数据表<span class="keyword">user</span> 有三个字段 ：id  <span class="keyword">user</span>  password</span><br><span class="line"></span><br><span class="line"><span class="keyword">create table</span> <span class="keyword">user</span>(</span><br><span class="line">id <span class="type">int</span> <span class="keyword">primary key</span> auto_increment,</span><br><span class="line"><span class="keyword">user</span> <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">password <span class="type">char</span>(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">其中有若干数据：</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert into</span> <span class="keyword">user</span> <span class="keyword">values</span></span><br><span class="line">(<span class="number">1</span>,&quot;Tom&quot;,<span class="string">&#x27;abc&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,&quot;Abby&quot;,&quot;321&quot;);</span><br><span class="line"></span><br><span class="line">编写一个函数，使用input分别输入用户名和密码</span><br><span class="line">验证是否可以登录成功，如果可以则返回<span class="literal">True</span></span><br><span class="line">不可以返回<span class="literal">False</span></span><br><span class="line"></span><br><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">class <span class="keyword">User</span>:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        kwargs <span class="operator">=</span> &#123;</span><br><span class="line">            &quot;host&quot;: &quot;localhost&quot;,</span><br><span class="line">            &quot;port&quot;: <span class="number">3306</span>,</span><br><span class="line">            &quot;user&quot;: &quot;root&quot;,</span><br><span class="line">            &quot;passwd&quot;: &quot;123456&quot;,</span><br><span class="line">            &quot;database&quot;: &quot;stu&quot;,</span><br><span class="line">            &quot;charset&quot;: &quot;utf8&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        self.db <span class="operator">=</span> pymysql.connect(<span class="operator">*</span><span class="operator">*</span>kwargs)</span><br><span class="line">        self.cur <span class="operator">=</span> self.db.cursor()</span><br><span class="line"></span><br><span class="line">    def <span class="keyword">close</span>(self):</span><br><span class="line">        self.cur.close()</span><br><span class="line">        self.db.close()</span><br><span class="line"></span><br><span class="line">    def login(self,name, passwd):</span><br><span class="line">        <span class="keyword">sql</span><span class="operator">=</span>&quot;select user from user &quot; \</span><br><span class="line">            &quot;where user=%s and password=%s;&quot;</span><br><span class="line">        self.cur.execute(<span class="keyword">sql</span>,[name,passwd])</span><br><span class="line">        # (name,) <span class="keyword">or</span>  <span class="keyword">None</span></span><br><span class="line">        if self.cur.fetchone():</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">if __name__ <span class="operator">=</span><span class="operator">=</span> <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">user</span> <span class="operator">=</span> <span class="keyword">User</span>()</span><br><span class="line">    # 登录验证</span><br><span class="line">    name<span class="operator">=</span>input(&quot;用户名：&quot;)</span><br><span class="line">    passwd<span class="operator">=</span>input(&quot;密 码：&quot;)</span><br><span class="line">    print(user.login(name,passwd))</span><br><span class="line"></span><br><span class="line">    user.close()</span><br></pre></td></tr></table></figure>

<ul>
<li>文件存储<ul>
<li>存储文件路径<ul>
<li>优点：节省数据库空间，提取方便</li>
<li>缺点：文件或者数据库发生迁移会导致文件丢失</li>
</ul>
</li>
<li>存储文件本身<ul>
<li>优点：安全可靠，数据库在文件就在</li>
<li>缺点：占用数据库空间大，文件存取效率低</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">静态文件存储示例：</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">存取二进制数据</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">kwargs = &#123;</span><br><span class="line">    <span class="string">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="string">&quot;port&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;stu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charset&quot;</span>: <span class="string">&quot;utf8&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接数据库</span></span><br><span class="line">db = pymysql.connect(**kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建游标  使用sql操作数据得到结果的对象</span></span><br><span class="line">cur = db.cursor()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储图片</span></span><br><span class="line"><span class="comment"># with open(&quot;left.png&quot;,&#x27;rb&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     data = f.read()</span></span><br><span class="line"><span class="comment"># sql = &quot;update class set image=%s where id=4;&quot;</span></span><br><span class="line"><span class="comment"># cur.execute(sql,[data])</span></span><br><span class="line"><span class="comment"># db.commit()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取出图片</span></span><br><span class="line">sql = <span class="string">&quot;select image from class where id=4;&quot;</span></span><br><span class="line">cur.execute(sql)</span><br><span class="line">data = cur.fetchone()[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;xxx.png&quot;</span>,<span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line">cur.close()</span><br><span class="line">db.close()</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xurucby.github.io">xuru</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xurucby.github.io/2026/01/13/MySQL/">https://xurucby.github.io/2026/01/13/MySQL/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://xurucby.github.io" target="_blank">xuru的技术学习博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/01/13/python%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="python网络编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">python网络编程</div></div><div class="info-2"><div class="info-item-1">1. 文件读写1.1 引入 什么是文件 文件是保存在持久化存储设备(硬盘、U盘、光盘..)上的一段数据，一个文本，一个py文件，一张图片，视频音频等这些都是文件。  文件分类  文本文件：打开后会自动解码为字符，如txt文件，word文件，py程序文件。 二进制文件：内部编码为二进制码，无法通过文字编码解析，如压缩包，音频，视频，图片等。   字节串类型  概念 ： 在python3中引入了字节串的概念，与str不同，字节串以字节序列值表达数据，更方便用来处理二进程数据。  字符串与字节串相互转化方法 12345- 普通的英文字符字符串常量可以在前面加b转换为字节串，例如：b&#x27;hello&#x27;- 变量或者包含非英文字符的字符串转换为字节串方法 ：str.encode()- 字节串转换为字符串方法 : bytes.decode() 注意：python字符串用来表达utf8字符，因为并不是所有二进制内容都可以转化为utf8字符，所以不是所有字节串都能转化为字符串，但是所有字符串都能转化成二进制，所以所有字符串都能转换为字节串。    1.2 文件读写操作使用程序操作文...</div></div></div></a><a class="pagination-related" href="/2026/01/13/Linux/" title="Linux"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Linux</div></div><div class="info-2"><div class="info-item-1">Linux 操作系统1. Linux操作系统认知1.1 操作系统（Operation System简称OS） 定义 操作系统是管理计算机硬件与软件资源的计算机程序，同时也是计算机系统的内核与基石。操作系统需要处理如管理与配置内存、决定系统资源供需的优先次序、控制输入设备与输出设备、操作网络与管理文件系统等基本事务。   操作系统功能   管理好硬件设备，为用户提供调用方法 是计算机中最重要的系统环境 管理各种其他的软件和程序的运行 对系统中文件进行管理    操作系统分类   桌面系统：Windows ，MacOS为主，图形界面良好用户群体大。 服务器系统：Linux，Unix为主，安全，稳定，费用低占有量大。windows占有率比较低。 嵌入式系统：Linux为主，主要用于小型智能设备，如智能手机，机器人等。     1.2 Linux系统介绍 Linux 诞生 1991 年 林纳斯（Linus） 就读于赫尔辛基大学期间，对 Unix 产生浓厚兴趣，林纳斯经常要用他的终端仿真器（Terminal Emulator） 去访问大学主机上的新闻组和邮件，为了方便读写和下载文件，他自己...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">xuru</div><div class="author-info-description">专注技术学习，分享学习之路，博客内容配套Gitee源码</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://gitee.com/xu-ru1" target="_blank" title="gitee"><i class="Gitee"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL"><span class="toc-number">1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.</span> <span class="toc-text">1. 数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-MySQL"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-SQL%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 SQL语言</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.</span> <span class="toc-text">2. 数据库基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 数据库管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 数据表管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.2.1 基础数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2.2 表的基本操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%A1%A8%E6%95%B0%E6%8D%AE%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 表数据基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E6%8F%92%E5%85%A5-insert"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">2.3.1 插入(insert)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E6%9F%A5%E8%AF%A2-select"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2.3.2 查询(select)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-where%E5%AD%90%E5%8F%A5"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">2.3.3 where子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-%E6%9B%B4%E6%96%B0%E8%A1%A8%E8%AE%B0%E5%BD%95-update"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">2.3.4 更新表记录(update)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5-%E5%88%A0%E9%99%A4%E8%A1%A8%E8%AE%B0%E5%BD%95%EF%BC%88delete%EF%BC%89"><span class="toc-number">1.2.3.5.</span> <span class="toc-text">2.3.5 删除表记录（delete）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-6-%E8%A1%A8%E5%AD%97%E6%AE%B5%E7%9A%84%E6%93%8D%E4%BD%9C-alter"><span class="toc-number">1.2.3.6.</span> <span class="toc-text">2.3.6 表字段的操作(alter)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-7-%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.3.7.</span> <span class="toc-text">2.3.7 时间类型数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.3.</span> <span class="toc-text">3. 高级查询语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 模糊查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-as-%E7%94%A8%E6%B3%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 as 用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E6%8E%92%E5%BA%8F"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%99%90%E5%88%B6"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.5.</span> <span class="toc-text">3.5 联合查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.3.6.</span> <span class="toc-text">3.7 子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">4. 聚合操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 聚合函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%81%9A%E5%90%88%E5%88%86%E7%BB%84"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 聚合分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%81%9A%E5%90%88%E7%AD%9B%E9%80%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 聚合筛选</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%8E%BB%E9%87%8D%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 去重语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%B4%A2%E5%BC%95%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.</span> <span class="toc-text">5. 索引操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 索引分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%B4%A2%E5%BC%95%E5%88%9B%E5%BB%BA"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 索引创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E5%92%8C%E8%A1%A8%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.</span> <span class="toc-text">6. 外键约束和表关联关系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 外键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E8%A1%A8%E5%85%B3%E8%81%94%E5%85%B3%E7%B3%BB"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 表关联关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-E-R%E6%A8%A1%E5%9E%8B%E5%9B%BE"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 E-R模型图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E8%A1%A8%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 表关联查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A7%86%E5%9B%BE"><span class="toc-number">1.7.</span> <span class="toc-text">7. 视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%87%BD%E6%95%B0%E5%92%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.8.</span> <span class="toc-text">8. 函数和存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%87%BD%E6%95%B0%E5%88%9B%E5%BB%BA"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 函数创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%88%9B%E5%BB%BA"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2存储过程创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E6%93%8D%E4%BD%9C"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 存储过程和存储函数操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-%E5%87%BD%E6%95%B0%E5%92%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%8C%BA%E5%88%AB"><span class="toc-number">1.8.4.</span> <span class="toc-text">8.4 函数和存储过程区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E4%BA%8B%E5%8A%A1%E6%8E%A7%E5%88%B6"><span class="toc-number">1.9.</span> <span class="toc-text">9. 事务控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E4%BA%8B%E5%8A%A1%E6%A6%82%E8%BF%B0"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 事务概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 事务操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E4%BA%8B%E5%8A%A1%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 事务四大特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">1.9.4.</span> <span class="toc-text">9.4 事务隔离级别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96"><span class="toc-number">1.10.</span> <span class="toc-text">10.数据库优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%8C%83%E5%BC%8F"><span class="toc-number">1.10.1.</span> <span class="toc-text">10.1 数据库设计范式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-MySQL%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">1.10.2.</span> <span class="toc-text">10.2  MySQL存储引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E5%AD%97%E6%AE%B5%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E9%94%AE%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.10.3.</span> <span class="toc-text">10.3 字段数据类型和键的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-SQL%E4%BC%98%E5%8C%96"><span class="toc-number">1.10.4.</span> <span class="toc-text">10.4 SQL优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-%E8%A1%A8%E7%9A%84%E6%8B%86%E5%88%86"><span class="toc-number">1.10.5.</span> <span class="toc-text">10.5 表的拆分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%92%8C%E5%AF%BC%E5%85%A5"><span class="toc-number">1.11.</span> <span class="toc-text">11. 数据备份和导入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6"><span class="toc-number">1.11.1.</span> <span class="toc-text">11.1 表的复制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E4%BB%BD"><span class="toc-number">1.11.2.</span> <span class="toc-text">11.2 数据库备份</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-number">1.12.</span> <span class="toc-text">12. 数据库管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-MySQL%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.12.1.</span> <span class="toc-text">12.1 MySQL远程连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E5%92%8C%E6%8E%88%E6%9D%83"><span class="toc-number">1.12.2.</span> <span class="toc-text">12.2 添加用户和授权</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-pymysql%E6%A8%A1%E5%9D%97"><span class="toc-number">1.13.</span> <span class="toc-text">13. pymysql模块</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/13/python%E5%AE%B9%E5%99%A8%E5%87%BD%E6%95%B0/" title="python容器函数">python容器函数</a><time datetime="2026-01-13T03:47:38.000Z" title="发表于 2026-01-13 11:47:38">2026-01-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/13/python%E9%AB%98%E7%BA%A7/" title="python高级">python高级</a><time datetime="2026-01-13T03:47:16.000Z" title="发表于 2026-01-13 11:47:16">2026-01-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/13/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="python面向对象">python面向对象</a><time datetime="2026-01-13T03:47:11.000Z" title="发表于 2026-01-13 11:47:11">2026-01-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/13/python%E6%A0%B8%E5%BF%83/" title="python核心">python核心</a><time datetime="2026-01-13T03:47:03.000Z" title="发表于 2026-01-13 11:47:03">2026-01-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/13/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="正则表达式">正则表达式</a><time datetime="2026-01-13T03:37:34.000Z" title="发表于 2026-01-13 11:37:34">2026-01-13</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By xuru</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>